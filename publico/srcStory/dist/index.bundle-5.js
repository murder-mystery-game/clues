(()=>{"use strict";class e{constructor(){this.touchstartSlideX=0,this.touchendSlideX=0,this.touchstartSlideY=0,this.touchendSlideY=0,this.scrollTopZona=0}swipeY(e,t){"touchstart"==e.type?this.touchstartSlideY=e.changedTouches[0].screenY:"touchend"==e.type&&(this.touchendSlideY=e.changedTouches[0].screenY,this[t]())}swipeYScroll(e,t){"touchstart"==e.type?(this.scrollTopZona=$(".js-zona-popup:visible .zona-popup-contenido").scrollTop(),this.touchstartSlideY=e.changedTouches[0].screenY):"touchend"==e.type&&(this.touchendSlideY=e.changedTouches[0].screenY,this[t]())}swipeDownFueraPopup(){const e=Math.abs(this.touchendSlideY-this.touchstartSlideY);this.touchendSlideY>this.touchstartSlideY&&e>60&&$(".js-fondo-negro-popup").trigger("click")}swipeDownDentroPopup(){0==this.scrollTopZona&&this.swipeDownFueraPopup()}}class t{constructor(e){this.context=e.context,"frontend"===this.context&&(this.selfGeneratedPopstate=!1,this.slidesHistory=[],this.selfActivatedGoToSlide=!1,window.history.replaceState({idInternoSlide:$("#js_zona_slides").find("section.swiper-slide-active").attr("data-id_interno_slide")},window.location.href),this.kite=e,this.activateListeners(),this.stateHistory=[],this.stateHistory.push({idInternoSlide:$("#js_zona_slides").find("section.swiper-slide-active").attr("data-id_interno_slide")}),this.popstateHistory=!0)}back(){this.context}checkSelfGeneratedPopstate(){this.context}protectDobleActionDueTogestures(){this.context}pushState(e={state:""},t=window.location.href){"frontend"===this.context&&(this.stateHistory.push(e),window.history.pushState(e,"",t))}changeSlideSwipe(){try{if("frontend"!==this.context)return;this.popstateHistory&&setTimeout((()=>{const e=$("#js_zona_slides").find("section.swiper-slide-active").attr("data-id_interno_slide");this.pushState({idInternoSlide:e},window.location.href)}),[100])}catch(e){}}addCurrentSlideToHistory(e=0){if(0===e){const e=$("#js_zona_slides").find("section.swiper-slide-active").attr("data-id_interno_slide");this.pushSlideGoTo(e)}else this.pushSlideGoTo(e)}pushSlideGoTo(e){"frontend"===this.context&&this.pushState({idInternoSlide:e},window.location.href)}activateListeners(){"frontend"===this.context&&(window.addEventListener("popstate",(async e=>{this.popstateHistory=!1;const t=window.history.state.idInternoSlide;this.selfActivatedGoToSlide=!0;const i=this.kite.kiteInfo.slides;for(let e=0;e<i.length;e++)if(i[e].id_interno_slide===t){"1"===i[e].oculto?await this.kite.goToHiddenSlide(t,0,!0):await this.kite.goToSlide(t,0);break}this.popstateHistory=!0})),this.kite.swiper.on("slideChange",(e=>{this.changeSlideSwipe()})))}}function i(e,t){if("Poppins"===e)return;const i={Alegreya:{regular:`url(${t}/publico/srcGlobal/fonts/Alegreya-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Alegreya-Bold.ttf)`},Arvo:{regular:`url(${t}/publico/srcGlobal/fonts/Arvo-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Arvo-Bold.ttf)`},BioRhyme:{regular:`url(${t}/publico/srcGlobal/fonts/BioRhyme-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/BioRhyme-Bold.ttf)`},Cairo:{regular:`url(${t}/publico/srcGlobal/fonts/Cairo-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Cairo-Bold.ttf)`},Chivo:{regular:`url(${t}/publico/srcGlobal/fonts/Chivo-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Chivo-Bold.ttf)`},"Concert One":{regular:`url(${t}/publico/srcGlobal/fonts/ConcertOne-Regular.ttf)`},"Cormorant Garamond":{regular:`url(${t}/publico/srcGlobal/fonts/CormorantGaramond-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/CormorantGaramond-Bold.ttf)`},"Crimson Text":{regular:`url(${t}/publico/srcGlobal/fonts/CrimsonText-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/CrimsonText-Bold.ttf)`},"Fjalla One":{regular:`url(${t}/publico/srcGlobal/fonts/FjallaOne-Regular.ttf)`},"Hind Siliguri":{regular:`url(${t}/publico/srcGlobal/fonts/HindSiliguri-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/HindSiliguri-Bold.ttf)`},"IBM Plex Sans Thai":{regular:`url(${t}/publico/srcGlobal/fonts/IBMPlexSansThai-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/IBMPlexSansThai-Bold.ttf)`},Karla:{regular:`url(${t}/publico/srcGlobal/fonts/Karla-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Karla-Bold.ttf)`},Lato:{regular:`url(${t}/publico/srcGlobal/fonts/Lato-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Lato-Bold.ttf)`},Merriweather:{regular:`url(${t}/publico/srcGlobal/fonts/Merriweather-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Merriweather-Bold.ttf)`},Montserrat:{regular:`url(${t}/publico/srcGlobal/fonts/Montserrat-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Montserrat-Bold.ttf)`},Muli:{regular:`url(${t}/publico/srcGlobal/fonts/Mulish-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Mulish-Bold.ttf)`},"Noto Sans Bengali":{regular:`url(${t}/publico/srcGlobal/fonts/NotoSansBengali-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/NotoSansBengali-Bold.ttf)`},Nunito:{regular:`url(${t}/publico/srcGlobal/fonts/Nunito-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Nunito-Bold.ttf)`},"Open Sans":{regular:`url(${t}/publico/srcGlobal/fonts/OpenSans-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/OpenSans-Bold.ttf)`},Oswald:{regular:`url(${t}/publico/srcGlobal/fonts/Oswald-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Oswald-Bold.ttf)`},Oxygen:{regular:`url(${t}/publico/srcGlobal/fonts/Oxygen-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Oxygen-Bold.ttf)`},"PT Sans":{regular:`url(${t}/publico/srcGlobal/fonts/PTSans-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/PTSans-Bold.ttf)`},"PT Serif":{regular:`url(${t}/publico/srcGlobal/fonts/PTSerif-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/PTSerif-Bold.ttf)`},"Paytone One":{regular:`url(${t}/publico/srcGlobal/fonts/PaytoneOne-Regular.ttf)`},"Playfair Display":{regular:`url(${t}/publico/srcGlobal/fonts/PlayfairDisplay-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/PlayfairDisplay-Bold.ttf)`},Prompt:{regular:`url(${t}/publico/srcGlobal/fonts/Prompt-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Prompt-Bold.ttf)`},Rakkas:{regular:`url(${t}/publico/srcGlobal/fonts/Rakkas-Regular.ttf)`},Raleway:{regular:`url(${t}/publico/srcGlobal/fonts/Raleway-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Raleway-Bold.ttf)`},Roboto:{regular:`url(${t}/publico/srcGlobal/fonts/Roboto-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Roboto-Bold.ttf)`},Rubik:{regular:`url(${t}/publico/srcGlobal/fonts/Rubik-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Rubik-Bold.ttf)`},"Source Sans":{regular:`url(${t}/publico/srcGlobal/fonts/SourceSansPro-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/SourceSansPro-Bold.ttf)`},"Space Mono":{regular:`url(${t}/publico/srcGlobal/fonts/SpaceMono-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/SpaceMono-Bold.ttf)`},Spectral:{regular:`url(${t}/publico/srcGlobal/fonts/Spectral-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Spectral-Bold.ttf)`},"Supermercado One":{regular:`url(${t}/publico/srcGlobal/fonts/SupermercadoOne-Regular.ttf)`},Ubuntu:{regular:`url(${t}/publico/srcGlobal/fonts/Ubuntu-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Ubuntu-Bold.ttf)`},Varela:{regular:`url(${t}/publico/srcGlobal/fonts/Varela-Regular.ttf)`},Vollkorn:{regular:`url(${t}/publico/srcGlobal/fonts/Vollkorn-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/Vollkorn-Bold.ttf)`},"Work Sans":{regular:`url(${t}/publico/srcGlobal/fonts/WorkSans-Regular.ttf)`,bold:`url(${t}/publico/srcGlobal/fonts/WorkSans-Bold.ttf)`},"Yatra One":{regular:`url(${t}/publico/srcGlobal/fonts/YatraOne-Regular.ttf)`}}[e];if(!i)return;if(new FontFace(e,i.regular).load().then((e=>{document.fonts.add(e)})),i.bold){new FontFace(e,i.bold,{weight:"700"}).load().then((e=>{document.fonts.add(e)}))}}function a(e){try{if(!e.tipografia)return;!async function(e,t=origin){const i=new FontFace(e.id,`url("${t}/${e.path}")`);await fetch(`${t}/${e.path}`).then((async t=>{t.ok&&(await i.load(),document.fonts.add(i),$(".fe-zona-slides")[0].style.setProperty("--fuenteGlobal",`"${e.id.toString()}"`))}))}(JSON.parse(e.tipografia),e.cdn)}catch{i(e.tipografia,e.cdn)}}function s(e,t,a){"string"==typeof e.style.tipografia?(t.css("font-family",e.style.tipografia),i(e.style.tipografia,a)):(t.css("font-family",`"${e.style.tipografia.id.toString()}"`),async function(e,t=origin){const i=new FontFace(e.id.toString(),`url("${t}/${e.path}")`);await i.load(),document.fonts.add(i)}(e.style.tipografia,a))}class o{static evitaScrollCssFrontend(){$("body").css({"overscroll-behavior-y":"contain",overflow:"hidden"}),$("html").css({"overscroll-behavior-y":"contain",overflow:"hidden"})}static barraCssSlide(e){const t=$(".barra-interior-estatica").eq(e),i=$(".barra-interior-estatica").slice(0,e);$(".barra-interior-estatica").slice(e+1).removeClass("activo pasado js-activa"),i.removeClass("activo js-activa"),i.addClass("pasado"),t.removeClass("pasado"),t.addClass("activo js-activa")}static deshabilitarCosasParaElDashboard(){document.querySelectorAll("#barra_exploracion").forEach((e=>{e.style.display="none"})),document.querySelectorAll(".js-flechas-movil").forEach(((e,t)=>{e.style.display="none"})),document.querySelectorAll(".js-boton-next.fe-boton-mas").forEach(((e,t)=>{e.style.pointerEvents="none"})),document.querySelectorAll(".js-capa-pulsable").forEach(((e,t)=>{e.style.display="none"}))}static cssNavegacionBotones(){$(".js-capa-pulsable-izquierda").remove(),$(".js-flechas-movil.izquierda").remove(),$(".js-capa-pulsable-derecha").remove(),$(".js-flechas-movil.derecha").remove(),$("#barra_exploracion").hide()}static cssNavegacionVertical(){$(".js-capa-pulsable-izquierda").remove(),$(".js-flechas-movil.izquierda").remove(),$(".js-capa-pulsable-derecha").remove(),$(".js-flechas-movil.derecha").remove(),$("#barra_exploracion").hide()}static cssNavegacionHorizontal(){$(".js-capa-pulsable-izquierda").remove(),$(".js-flechas-movil.izquierda").remove(),$(".js-capa-pulsable-derecha").remove(),$(".js-flechas-movil.derecha").remove(),$("#barra_exploracion").hide()}static gestionDesktop(){window.innerWidth>768&&($(".js-capa-pulsable-derecha").remove(),$(".js-capa-pulsable-izquierda").remove())}static ocultaBarraNavegacionUnaSlide(e){e<2&&$("#barra_exploracion").hide()}static hidePulsablesIzquierda(){$(".js-flechas-movil.izquierda").hide(),$(".js-capa-pulsable-izquierda").hide(),$(".js-flechas-movil-popstate").hide()}static hidePulsablesDerecha(){$(".js-flechas-movil.derecha").hide(),$(".js-capa-pulsable-derecha").hide()}static resetCapasPulsables(e){"frontend"==e&&($(".js-flechas-movil").show(),$(".js-capa-pulsable-izquierda").show(),$(".js-capa-pulsable-derecha").show())}static activarMarkers(){$(".fe-marker-elemento").addClass("pulsable animacion"),$(".fe-marker-elemento").css("pointer-events","auto")}static desactivarMarkers(){$(".fe-marker-elemento").removeClass("pulsable animacion"),$(".fe-marker-elemento").css("pointer-events","none !important")}static cancelarPulsaciones(){$(".pulsable").css("pointer-events","none")}static activarPulsaciones(){$(".pulsable").css("pointer-events","auto")}static accionesDependientesDelIndexDeLaSlide(e,t){o.resetCapasPulsables(e),t.isBeginning&&o.hidePulsablesIzquierda(),t.isEnd&&o.hidePulsablesDerecha()}}class n{constructor(e,t){if(this.slideInfo=e,"object"!=typeof this.slideInfo.objetoBlobSlide)throw new Error("objetoBlobSlide is not an object");this.idSlide=this.slideInfo.id_slide,this.slideDivJQuery=$(`.js-slide-frontend[id_slide='${this.idSlide}']`),this.activated=!1,this.firstTime=!1,this.kite=t,this.loading=!1}activate(){this.activated=!0,this.activateListeners(),this.activateEspecifico();const e={category:"view",action:"slide",slideId:this.idSlide};$(document).trigger("activatedSlide",[this.idSlide]),this.kite.analytics.sendEvent(e),"1"==this.slideInfo.oculto&&($(".js-capa-pulsable-izquierda").hide(),$(".js-flechas-movil.izquierda").hide(),$(".js-capa-pulsable-derecha").hide(),$(".js-flechas-movil.derecha").hide(),$("#barra_exploracion").hide(),this.kite.tieneMousewheel&&this.kite.swiper.mousewheel.disable()),this.checkeaQuitarFlechasCssSiSlideBloqueada(),"frontend"==this.kite.context&&this.checkeaBloquearSwiperSiSlideBloqueada()}activateEspecifico(){}deactivate(){this.activated&&(this.activated=!1,this.deactivateListeners(),this.deactivateEspecifico(),"1"==this.slideInfo.oculto&&(this.slideDivJQuery.hide(),this.kite.tieneMousewheel&&this.kite.swiper.mousewheel.enable()))}deactivateEspecifico(){}activateListeners(){this.activateListenersEspecifico()}activateListenersEspecifico(){}deactivateListeners(){this.deactivateListenersEspecifico(),"frontend"==this.kite.context&&(this.kite.swiper.off("sliderFirstMove"),this.kite.swiper.off("scroll"),$(document).off("clickBotonNext"),$(document).off("clickBotonPrev"))}deactivateListenersEspecifico(){}checkeaQuitarFlechasCssSiSlideBloqueada(){this.slideInfo.objetoBlobSlide.navegacion&&this.slideInfo.objetoBlobSlide.navegacion.bloqueo_avance&&($(".js-boton-next").hide(),$(".js-capa-pulsable-derecha").hide()),this.slideInfo.objetoBlobSlide.navegacion&&this.slideInfo.objetoBlobSlide.navegacion.bloqueo_vuelta&&($(".js-boton-previous").hide(),$(".js-capa-pulsable-izquierda").hide())}checkeaBloquearSwiperSiSlideBloqueada(){this.slideInfo.objetoBlobSlide.navegacion&&this.slideInfo.objetoBlobSlide.navegacion.bloqueo_avance?this.kite.swiper.allowSlideNext=!1:this.kite.swiper.allowSlideNext=!0,this.slideInfo.objetoBlobSlide.navegacion&&this.slideInfo.objetoBlobSlide.navegacion.bloqueo_vuelta?this.kite.swiper.allowSlidePrev=!1:this.kite.swiper.allowSlidePrev=!0}}const r=new class{constructor(){this.libreriaSpotify=!1,this.libreriaAddCalendarLoaded=!1,this.libreriaAutosize=!1,this.libreriaCookieConsent=!1,this.libreriaMapbox=!1}setCDN(e){this.cdn=e}async cargaLibreria(e){try{if(void 0===this.cdn)return;this["carga"+e]()}catch(e){}}cargaSpotify(){if(this.libreriaSpotify)return;this.libreriaSpotify=!0;const e=document.createElement("script");$("body").append(e),e.src="https://open.spotify.com/embed-podcast/iframe-api/v1",e.async=!0}cargaAddCalendar(){if(this.libreriaAddCalendarLoaded)return;this.libreriaAddCalendarLoaded=!0;const e=document.createElement("script");$("body").append(e),e.src=`${this.cdn}/publico/srcGlobal/js/add-to-calendar-button.js`,e.async=!0,e.defer=!0;const t=document.createElement("link");$("head").append(t),t.rel="stylesheet",t.href=`${this.cdn}/publico/srcGlobal/css/atcb.min.css`}cargaAutosize(){if(this.librerialibreriaAutosize)return;this.libreriaAutosize=!0;const e=document.createElement("script");$("body").append(e),e.onload=function(){autosize(document.querySelectorAll("textarea"))},e.src=`${this.cdn}/publico/srcGlobal/js/autosize.min.js`}cargaTypeform(){const e=document.createElement("script");$("body").append(e),e.src="//embed.typeform.com/next/embed.js"}async cargaCookieConsent(){return new Promise(((e,t)=>{if(this.libreriaCookieConsent)return;this.libreriaCookieConsent=!0;const i=document.createElement("script");$("body").append(i),i.src=`${this.cdn}/publico/srcGlobal/js/cookieconsent.js`;const a=document.createElement("link");$("head").append(a),a.rel="stylesheet",a.href=`${this.cdn}/publico/srcGlobal/css/cookieconsent.css`,i.onload=function(){e()}}))}cargaMapbox(){if(this.libreriaMapbox)return;this.libreriaMapbox=!0;const e=document.createElement("script");e.setAttribute("src",`${this.cdn}/publico/srcGlobal/js/mapbox-gl.js`),document.body.appendChild(e),e.addEventListener("load",(function(){$(document).trigger("mapboxLoaded")}),!1);const t=document.createElement("link");t.rel="stylesheet",t.href=`${this.cdn}/publico/srcGlobal/css/mapbox-gl.css`,$("head").append(t)}};class l{constructor(e,t,i,a){try{switch(this.kite=e,this.idElemento=t,this.idSlide=i,this.datosFuncionalidad=a,this.tipoFuncionalidad=this.datosFuncionalidad.tipo,this.slideDivJQuery=$(`.js-slide-frontend[id_slide='${this.idSlide}']`),this.elementoDivJQuery=$(`.js-slide-frontend[id_slide='${this.idSlide}']`).find(`.js-elemento-libre[data-id_elemento='${this.idElemento}']`),this.divListener=$(`.js-boton-funcionalidad[data-id_slide='${this.idSlide}'][data-id_elemento='${this.idElemento}']`),this.activated=!1,this.popupIframe=!1,this.deferredPrompt=null,this.tipoFuncionalidad){case"sin_funcionalidad":case void 0:case null:this.elementoSinFuncionalidad();break;case"popup":this.crearPopup();break;case"addcalendar":r.cargaLibreria("AddCalendar");break;case"shortcut":this.crearBannerDownloadAppIphone(),window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.deferredPrompt=e}))}}catch(e){}}activate(){this.activated=!0,this.activateListeners()}deactivate(){if(this.activated=!1,this.deactivateListeners(),"popup"===this.tipoFuncionalidad)this.desactivarPopup()}activateListeners(){try{const e=this;switch(this.tipoFuncionalidad){case"popup":case"shortcut":this.fondoNegroPopup.on("click",(()=>{e.desactivarPopup()})),this.fondoNegroPopup.on("touchstart touchend",(e=>{this.kite.popupsSwiper.swipeY(e,"swipeDownFueraPopup")})),this.popup.on("touchstart touchend",".js-borde-superior-popup",(e=>{this.kite.popupsSwiper.swipeY(e,"swipeDownFueraPopup")})),this.popup.on("touchstart touchend",(e=>{this.kite.popupsSwiper.swipeYScroll(e,"swipeDownDentroPopup")}))}}catch(e){}}deactivateListeners(){try{const e=this;switch(this.tipoFuncionalidad){case"popup":case"shortcut":e.fondoNegroPopup.off(),e.popup.off()}}catch(e){}}ejecutarFuncionalidad(){const e={category:"click",action:this.tipoFuncionalidad,label:this.idElemento,slideId:this.idSlide};if("sin_funcionalidad"!==this.tipoFuncionalidad&&"frontend"===this.kite.context){this.kite.analytics.sendEvent(e);const t={popup:"Open Pop Up",link:"External link",gotoslide:"Go to slide",gotokite:"Go to Kite",nextslide:"Next slide",previousslide:"Previous slide",llamar:"Phone call",sms:"Texting",share_kite:"Share this Kite",email:"Send email",whatsapp:"Send whatsapp",descargar:"Download pdf",vcard:"Save contact",addcalendar:"Add to calendar",payment_link:"Payment link",history_back:"History back",trigger:"Trigger JS",submit_freeform:"Submit freeform"}[this.tipoFuncionalidad]||"",i=this.elementoDivJQuery.attr("id")||"undefined";let a={};"link"===this.tipoFuncionalidad&&(a={link_url:this.datosFuncionalidad?.link?.url||"undefined",link_domain:this.datosFuncionalidad?.link?.url.split("/")[2]||"undefined",outbound:!0,page_location:window.location?.href||"undefined"}),this.kite.analytics.sendEventGA4(t,i,a)}switch(this.tipoFuncionalidad){case"sin_funcionalidad":default:break;case"popup":this.ejecutarPopup();break;case"link":this.ejecutarLink();break;case"gotoslide":this.ejecutarGoToSlide();break;case"gotokite":this.ejecutarGoToKite();break;case"nextslide":this.ejecutarNextSlide();break;case"previousslide":this.ejecutarPreviousSlide();break;case"llamar":this.ejecutarLlamar();break;case"sms":this.ejecutarSms();break;case"share_kite":this.ejecutarShareKite();break;case"email":this.ejecutarEmail();break;case"whatsapp":this.ejecutarWhatsapp();break;case"descargar":this.ejecutarDescargar();break;case"vcard":this.ejecutarVcard();break;case"addcalendar":this.ejecutarAddCalendar();break;case"payment_link":this.ejecutarPaymentLink();break;case"history_back":this.ejecutarHistoryBack();break;case"shortcut":this.ejecutarShortcut();break;case"trigger":this.ejecutarTrigger();break;case"submit_freeform":this.ejecutarSubmitFreeform()}}elementoSinFuncionalidad(){this.divListener.css("pointer-events","none"),this.divListener.closest(".js-elemento-libre").css("pointer-events","none")}crearPopup(){const e=this.idSlide,t=this.idElemento,i=this.datosFuncionalidad.popup,a=i.tipo_popup,s=this.kite.kiteInfo.cdn||"http://localhost:8080";let o="";if("imagen"==a){const a=i.imagen_popup,n=a.split(".").pop(),r=a.includes("unsplash")?a+"?w=1024":a.includes("http")?a:`${s}/${a}`,l=r.includes(s)?r.replace(`.${n}`,`_R1024.${n}`):r;o=`\n            <div class="fe-zona-popup js-zona-popup" id="contenido_marker_${e}_${t}" tipo="${i.tipo_popup}" style="display: none;">\n                <div class="fe-borde-superior-popup js-borde-superior-popup"><div></div></div>\n                <div class="zona-popup-contenido">\n                    <div class="pre-imagen-modal mbx-3">\n                        <img loading="lazy" src="${l}" onerror="this.onerror=null;this.src='${r}'" alt="" class="imagen-modal">\n                    </div>\n                    <span class="mbx-2 wrap-word ga-titulo-popup" style="font-weight:bold; font-size: 21px;">${i.titulo_popup}</span>\n                    <span class="mbx-3 pre-line" style="font-size: 14px;">${i.descripcion_popup}</span>\n                </div>\n            </div>`}else if("video"==a){const a=i.video_popup;o=`\n            <div class="fe-zona-popup js-zona-popup" id="contenido_marker_${e}_${t}" tipo="${i.tipo_popup}" style="display: none;">\n                <div class="fe-borde-superior-popup js-borde-superior-popup"><div></div></div>\n                <div class="zona-popup-contenido">\n                    <video preload="none" id="player_marker_${e}_${t}" class="video-popup mbx-3" autoplay muted playsinline controls>\n                        <source src="${s}/${a}" type="video/mp4" >\n                    </video>\n                    <span class="mbx-2 wrap-word ga-titulo-popup" style="font-weight:bold; font-size: 21px;">${i.titulo_popup}</span>\n                    <span class="mbx-3 pre-line" style="font-size: 14px;">${i.descripcion_popup}</span>\n                </div>\n            </div>`}else if("kite"==a){const a=this.kite.scale||1,s=.01*window.innerHeight*70/a;o=`\n                <div class="fe-zona-popup js-zona-popup" id="contenido_marker_${e}_${t}" tipo="${i.tipo_popup}" style="display: none;">\n                    <div class="fe-borde-superior-popup js-borde-superior-popup"><div></div></div>\n                    <div class="zona-popup-contenido" style='height:${s}px; flex: 0 0 auto'>\n                        <iframe loading="lazy" style="width: 100%; height:100%;" src="" frameborder="0"></iframe>\n                    </div>\n                </div>`}else o=`\n            <div class="fe-zona-popup js-zona-popup" id="contenido_marker_${e}_${t}" tipo="${i.tipo_popup}" style="display: none;">\n                <div class="fe-borde-superior-popup js-borde-superior-popup"><div></div></div>\n                <div class="zona-popup-contenido">\n                    <span class="mbx-2 wrap-word ga-titulo-popup" style="font-weight:bold; font-size: 21px;">${i.titulo_popup}</span>\n                    <span class="mbx-3 pre-line" style="font-size: 14px;">${i.descripcion_popup}</span>\n                </div>\n            </div>`;const n=`<div class="fe-fondo-negro-popup js-fondo-negro-popup" id="fondo_negro_${e}_${t}" style="background-color: rgba(26,26,26,0.56); display: none;"></div>`;this.popup=$(o).appendTo(this.slideDivJQuery),this.fondoNegroPopup=$(n).appendTo(this.slideDivJQuery),this.popupActivated=!1,this.playerPopup=!1}ejecutarPopup(){this.popupActivated=!0;const e=this.datosFuncionalidad.popup,t=e.tipo_popup,i=this;this.fondoNegroPopup.removeClass("animate__animated animate__fadeOut animate__rapido").addClass("animate__animated animate__fadeIn animate__rapido").show(),this.popup.removeClass("animate__animated animate__slideOutDown animate__faster").addClass("animate__animated animate__slideInUp animate__faster").show(),this.slideDivJQuery.trigger("openPopup"),"video"===t&&(i.playerPopup=document.querySelector("#player_marker_"+this.idSlide+"_"+this.idElemento),i.playerPopup&&(i.playerPopup.currentTime=0,i.playerPopup.play())),"kite"!==t||this.popupIframe||(this.popupIframe=!0,this.popup.find("iframe")[0].src=e.kite_popup),"frontend"===this.kite.context&&"botones"!==this.kite.navigation&&(this.kite.swiper.allowTouchMove=!1,this.kite.tieneMousewheel&&this.kite.swiper.mousewheel.disable())}desactivarPopup(){this.popupActivated=!1;const e=this;this.fondoNegroPopup.removeClass("animate__animated animate__fadeIn animate__faster").addClass("animate__animated animate__fadeOut animate__faster"),this.popup.removeClass("animate__animated animate__slideInUp animate__faster").addClass("animate__animated animate__slideOutDown animate__faster"),setTimeout((()=>{this.fondoNegroPopup.hide(),this.popup.hide()}),500),this.slideDivJQuery.trigger("closePopup"),this.playerPopup&&e.playerPopup.pause(),"frontend"===this.kite.context&&"botones"!==this.kite.navigation&&(this.kite.swiper.allowTouchMove=!0,this.kite.tieneMousewheel&&this.kite.swiper.mousewheel.enable())}ejecutarLink(){window.open(`${this.datosFuncionalidad.link.url}`,`${this.datosFuncionalidad.link.tipo}`)}async ejecutarGoToSlide(){if("dashboard"==this.kite.context)$(`.js-slide-story[data-id_interno_slide='${this.datosFuncionalidad.gotoslide.id_interno_slide}']`).click();else{const e=this.datosFuncionalidad.gotoslide;this.goToSlideAction(e);const t=e.id_interno_slide;$(`.js-slide-frontend[data-id_interno_slide='${t}']`).find(".js-zona-elementos-fullscreen").scrollTop(0)}}async goToSlideAction(e){if(e&&"id_interno_slide"in e){const t=this.kite.findSlideInstanceFromIdInternoSlide(e.id_interno_slide)?.slideInfo;if("1"==t?.oculto)this.kite.goToHiddenSlide(e.id_interno_slide);else{this.kite.swiper.allowSlidePrev=!0,this.kite.swiper.allowSlideNext=!0;try{await this.kite.goToSlide(e.id_interno_slide,e.velocidad)}catch(e){}}}}ejecutarGoToKite(){const e=this.datosFuncionalidad.gotokite.hash,t=this.datosFuncionalidad.gotokite.slide,i=this.kite.kiteInfo.host+"/"+e+"?slide="+t;"dashboard"==this.kite.context?alert("This functionality is not available in the dashboard"):window.open(`${i}`,"_self")}ejecutarNextSlide(){"dashboard"==this.kite.context?$(`.js-slide-story[data-idslide='${this.idSlide}']`).next(".js-slide-story").click():(this.kite.swiper.allowSlideNext=!0,this.kite.swiper.slideNext(),this.kite.indexStoryHistoryManager.addCurrentSlideToHistory())}ejecutarPreviousSlide(){"dashboard"==this.kite.context?$(`.js-slide-story[data-idslide='${this.idSlide}']`).prev(".js-slide-story").click():(this.kite.swiper.allowSlidePrev=!0,this.kite.swiper.slidePrev(),this.kite.indexStoryHistoryManager.addCurrentSlideToHistory())}ejecutarLlamar(){window.open(`tel:${this.datosFuncionalidad.llamar.numero}`,"_blank")}ejecutarSms(){window.open(`sms:${this.datosFuncionalidad.sms.numero}`,"_blank")}ejecutarShareKite(){const e=window.location.href,t=this.datosFuncionalidad?.share_kite?.text||"",i=this.datosFuncionalidad?.share_kite?.title||"";navigator?.share&&navigator.share({title:i,text:t,url:e}).then((()=>{})).catch((e=>{}))}ejecutarEmail(){window.location.href=`mailto:${this.datosFuncionalidad.email.direccion}?subject=${this.datosFuncionalidad.email.asunto}&body=${this.datosFuncionalidad.email.mensaje}`}ejecutarWhatsapp(){window.open(`https://wa.me/${this.datosFuncionalidad.whatsapp.numero}/?text=${this.datosFuncionalidad.whatsapp.mensaje}`,"_blank")}ejecutarDescargar(){if(this.datosFuncionalidad.descargar.pdf_file){const e=this.kite.kiteInfo.cdn||"https://static.qrkit.es",t=document.createElement("a");t.href=e+"/"+this.datosFuncionalidad.descargar.pdf_file,t.target="_blank",t.download="file.pdf",t.dispatchEvent(new MouseEvent("click"))}}ejecutarPaymentLink(){this.datosFuncionalidad.payment_link.url&&window.open(`${this.datosFuncionalidad.payment_link.url}`,"_blank")}async ejecutarVcard(){const e={name:"",formated_name:"",company:"ORG:",title:"TITLE:",telcell:"TEL;TYPE=cell:",telwork:"TEL;TYPE=work:",emailwork:"EMAIL;TYPE=work:",web:"URL;TYPE=work:",adress:"ADR;TYPE=work:"};let t=`BEGIN:VCARD%0AVERSION:3.0%0AN:${this.datosFuncionalidad.vcard.lastname};${this.datosFuncionalidad.vcard.firstname}%0AFN:${this.datosFuncionalidad.vcard.firstname} ${this.datosFuncionalidad.vcard.lastname}%0A`;for(const i of Object.keys(e))this.datosFuncionalidad.vcard[i]&&(t+=e[i],t+=this.datosFuncionalidad.vcard[i]+"%0A");t+="END:VCARD",window.open("data:text/x-vcard;urlencoded,"+t)}ejecutarAddCalendar(){const e={name:this.datosFuncionalidad.addcalendar.name,description:this.datosFuncionalidad.addcalendar.description,startDate:this.datosFuncionalidad.addcalendar.start_date,startTime:this.datosFuncionalidad.addcalendar.start_time?this.datosFuncionalidad.addcalendar.start_time:void 0,endDate:this.datosFuncionalidad.addcalendar.end_date?this.datosFuncionalidad.addcalendar.end_date:void 0,endTime:this.datosFuncionalidad.addcalendar.end_time?this.datosFuncionalidad.addcalendar.end_time:void 0,location:this.datosFuncionalidad.addcalendar.location,language:["ar","cs","de","en","es","fi","fr","hi","id","it","ja","ko","nl","no","ro","pl","pt","sv","tr","vi","zh"].includes(this.kite.language)?this.kite.language:"en",options:["Google","iCal","Microsoft365","MicrosoftTeams","Outlook.com","Apple"],timeZone:this.datosFuncionalidad.addcalendar?.time_zone?this.datosFuncionalidad.addcalendar.time_zone:"Europe/Madrid",iCalFileName:"Reminder-Event"};atcb_action(e)}ejecutarHistoryBack(){"dashboard"==this.kite.context?alert("This functionality is not available in the dashboard"):history.back()}crearBannerDownloadAppIphone(){const e=this.idSlide,t=this.idElemento,i=(this.kite.kiteInfo.cdn,`\n            <div class="fe-zona-popup js-zona-popup" id="contenido_marker_${e}_${t}" style="display: none;">\n                <div class="fe-borde-superior-popup js-borde-superior-popup"></div>\n                <iframe height="800px" src="https://qrkit.es/e02f5550">\n                </iframe>\n            </div>`),a=`<div class="fe-fondo-negro-popup js-fondo-negro-popup" id="fondo_negro_${e}_${t}" style="background-color: rgba(26,26,26,0.56); display: none;"></div>`;this.popup=$(i).appendTo(this.slideDivJQuery),this.fondoNegroPopup=$(a).appendTo(this.slideDivJQuery),this.popupActivated=!1,this.playerPopup=!1}ejecutarBannerDownloadAppIphone(){this.popupActivated=!0,this.fondoNegroPopup.removeClass("animate__animated animate__fadeOut animate__rapido").addClass("animate__animated animate__fadeIn animate__rapido").show(),this.popup.removeClass("animate__animated animate__slideOutDown animate__faster").addClass("animate__animated animate__slideInUp animate__faster").show(),this.slideDivJQuery.trigger("openPopup"),"frontend"===this.kite.context&&"botones"!==this.kite.navigation&&(this.kite.swiper.allowTouchMove=!1,this.kite.tieneMousewheel&&this.kite.swiper.mousewheel.disable())}desactivarBannerDownloadAppIphone(){this.popupActivated=!1,this.fondoNegroPopup.removeClass("animate__animated animate__fadeIn animate__faster").addClass("animate__animated animate__fadeOut animate__faster"),this.popup.removeClass("animate__animated animate__slideInUp animate__faster").addClass("animate__animated animate__slideOutDown animate__faster"),setTimeout((()=>{this.fondoNegroPopup.hide(),this.popup.hide()}),500),this.slideDivJQuery.trigger("closePopup")}async ejecutarShortcut(){if(await this.registerServiceWorker(),!this.isInUnavailableContext())if(this.deferredPrompt)try{this.deferredPrompt.prompt();(await this.deferredPrompt.userChoice).outcome}catch(e){}else this.ejecutarBannerDownloadAppIphone()}async registerServiceWorker(){if("frontend"===this.kite.context&&"serviceWorker"in navigator)try{await navigator.serviceWorker.register("/service-worker.js")}catch(e){}}async unregisterServiceWorker(){if("serviceWorker"in navigator){const e=await navigator.serviceWorker.getRegistrations();for(const t of e)await t.unregister()}}isInUnavailableContext(){return!("dashboard"!==this.kite.context&&"dashboard-layout"!==this.kite.context)&&(alert("This functionality is not available in the dashboard"),!0)}ejecutarTrigger(){const e=this.datosFuncionalidad.trigger.event,t=this.datosFuncionalidad.trigger.data,i=new CustomEvent(e,{detail:{data:t}});document.dispatchEvent(i)}async ejecutarSubmitFreeform(){if("dashboard"==this.kite.context)alert("This functionality is not available in the dashboard");else{if(this.submitting)return;const e=$(".js-freeform-element"),t=new FormData;t.append("owner",this.kite.kiteInfo.owner),t.append("id_origen",this.kite.idKite||document.body.dataset.idorigen),t.append("id_slide",this.idSlide||document.body.dataset.idslide),t.append("id_elemento",this.idElemento);for(const i of e){const e=$(i).attr("type");if($(i).attr("required")&&!$(i).val()){const e=$(i).closest("section").data("id_interno_slide"),t={};return t.id_interno_slide=e,t.velocidad=0,this.goToSlideAction(t),void i.reportValidity()}if("checkbox"===e&&$(i).attr("required")&&!$(i).is(":checked")){const e=$(i).closest("section").data("id_interno_slide"),t={};return t.id_interno_slide=e,t.velocidad=0,this.goToSlideAction(t),void i.reportValidity()}const a=$(i).attr("name");let s=$(i).val();"file"===e&&(s=$(i).prop("files")[0]),"checkbox"!==e||$(i).is(":checked")||(s=""),t.append(a,s)}this.submitting=!0;for(const e of t);const i=this.kite.kiteInfo.host.replace("//","//upload."),a=this.kite.idKite||document.body.dataset.idorigen;$.ajax({url:`${i}/formulario_freeform/${a}`,type:"POST",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){},error:function(e){}});const s=this.datosFuncionalidad.submit_freeform;this.goToSlideAction(s)}}}class c extends n{constructor(e,t){super(e,t),this.playerFullscreen=document.querySelector("#player_fullscreen_"+this.idSlide),this.botones={},this.createFuncionalidadesAntiguas()}activateEspecifico(){this.activarVideo();for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){this.pausarVideoPrevio();for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadesAntiguas(){const e=this;for(const t of Object.values(this.slideInfo.objetoBlobSlide.botones||{})){const i=new l(e.kite,t.id_boton,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_elemento='${t.id_boton}']`),this.botones[t.id_boton]=i}}activateListenersEspecifico(){$(".js-boton-silencio-video").on("click",(e=>{this.playerFullscreen.muted?(this.playerFullscreen.muted=!1,$(e.currentTarget).addClass("active")):(this.playerFullscreen.muted=!0,$(e.currentTarget).removeClass("active"))})),$(".js-boton-play-video").on("click",(e=>{this.playerFullscreen.paused?(this.playerFullscreen.play(),$(e.currentTarget).removeClass("active")):(this.playerFullscreen.pause(),$(e.currentTarget).addClass("active"))})),$(".js-capa-pulsable").on("mousedown mouseup",(e=>{this.playerFullscreen&&("mousedown"===e.type?this.playerFullscreen.pause():this.playerFullscreen.play())})),$(".js-capa-pulsable").on("touchstart touchend",(e=>{this.playerFullscreen&&("touchstart"===e.type?this.playerFullscreen.pause():this.playerFullscreen.play())})),this.slideDivJQuery.on("openPopup",(()=>{this.playerFullscreen.pause()})),this.slideDivJQuery.on("closePopup",(()=>{this.playerFullscreen.play()}));for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){$(".js-boton-silencio-video").off(),$(".js-boton-play-video").off(),$(".js-capa-pulsable").off(),this.slideDivJQuery.off("openPopup"),this.slideDivJQuery.off("closePopup");for(const e of Object.values(this.botones))e.divListener.off()}activarVideo(){if(!this.playerFullscreen)return;const e=this.playerFullscreen.dataset.final,t=this.playerFullscreen.dataset.sonido;"next-slide"==e?(this.activarVideoNoBucle(),this.pasarSlideAlTerminarVideo()):this.activarVideoEnBucle(),"no"==t||this.activarSonidoVideo()}activarVideoEnBucle(){this.playerFullscreen&&(this.playerFullscreen.loop=!0,this.playerFullscreen.play(),this.slideDivJQuery.find(".js-boton-play-video").removeClass("active"))}activarVideoNoBucle(){this.playerFullscreen&&(this.playerFullscreen.loop=!1,this.playerFullscreen.play(),this.slideDivJQuery.find(".js-boton-play-video").removeClass("active"))}activarSonidoVideo(){"frontend"==this.kite.context&&this.playerFullscreen.muted&&navigator?.userActivation?.isActive&&this.slideDivJQuery.find(".js-boton-silencio-video")[0].click()}pausarVideoPrevio(){this.playerFullscreen&&(this.playerFullscreen.pause(),this.playerFullscreen.currentTime=0)}pasarSlideAlTerminarVideo(){this.playerFullscreen&&(this.playerFullscreen.onended=()=>{this.kite.swiper.slideNext(),this.kite.indexStoryHistoryManager.addCurrentSlideToHistory()})}}class d extends n{constructor(e,t){super(e,t),this.botones={},this.createFuncionalidadesAntiguas()}activateEspecifico(){for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadesAntiguas(){const e=this;for(const t of Object.values(this.slideInfo.objetoBlobSlide.botones||{})){const i=new l(e.kite,t.id_boton,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_elemento='${t.id_boton}']`),this.botones[t.id_boton]=i}}activateListenersEspecifico(){for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){for(const e of Object.values(this.botones))e.divListener.off()}}class u{static previewImage(){$(".js-input-image").change((function(){!function(e){const t=$(e).closest(".js-zona-input-image").find(".js-preview-image"),i=$(e).closest(".js-zona-input-image").find(".js-preview-text"),a=$(e).closest(".js-zona-input-image").find(".js-preview-loader");if(e.files&&e.files[0]){const s=new FileReader;i.hide(),t.hide(),a.show(),e.files[0].type.match("image.*")?(s.onload=function(e){a.hide(),t.attr("src",e.target.result),t.show(),t.css("max-width","100%"),t.css("max-height","100%")},s.readAsDataURL(e.files[0])):e.files[0]&&(s.fileName=e.files[0].name,s.onload=function(e){a.hide(),i.text(e.target.fileName),i.show()},s.readAsDataURL(e.files[0]))}}(this)}))}static checkSizeImage(e=25){$(".js-input-image").change((function(){var t;(t=this).files[0].size/1048576>e&&(alert("File max size is "+e+"MB"),t.value="")}))}static cambiaPlaceholders(e){let t="Type here...",i="Send",a="Must be a number";switch(e){case"af":t="Skryf hier...",i="Stuur",a="Dit moet 'n nommer wees";break;case"ar":t="اكتب هنا...",i="إرسال",a="يجب أن يكون رقما";break;case"az":t="Burada yazın...",i="Göndər",a="Bu bir nömrə olmalıdır";break;case"ca":t="Escriu aquí...",i="Enviar",a="Ha de ser un número";break;case"cs":t="Napište sem...",i="Odeslat",a="To musí být číslo";break;case"da":t="Skriv her...",i="Send",a="Det skal være et nummer";break;case"de":t="Antwort hier...",i="Senden",a="Muss eine Zahl sein";break;case"es":case"gl":t="Escribe aquí...",i="Enviar",a="Debe ser un número";break;case"eu":t="Idatzi hemen...",i="Bidali",a="Zenbaki bat izan behar da";break;case"fa":t="اینجا بنویسید...",i="ارسال",a="این باید یک عدد باشد";break;case"fr":t="Répondez ici...",i="Envoyer",a="Doit être un nombre";break;case"hi":t="यहां लिखें...",i="भेजें",a="यह एक संख्या होनी चाहिए";break;case"in":t="Tulis di sini...",i="Kirim",a="Ini harus berupa angka";break;case"it":t="Scrivi qui...",i="Inviare",a="Deve essere un numero";break;case"ja":t="ここに書いてください...",i="送信",a="これは数字でなければなりません";break;case"ko":t="여기에 작성하십시오...",i="보내기",a="이것은 숫자여야 합니다";break;case"mn":t="Энд бичнэ үү...",i="Илгээх",a="Энэ нь тоо байх ёстой";break;case"nl":t="Schrijf hier...",i="Versturen",a="Dit moet een nummer zijn";break;case"pt":t="Responda aqui...",i="Enviar",a="Deve ser um número";break;case"pl":t="Napisz tutaj...",i="Wyślij",a="To musi być liczba";break;case"ru":t="Напишите здесь...",i="Отправить",a="Это должно быть число";break;case"th":t="เขียนที่นี่...",i="ส่ง",a="ต้องเป็นตัวเลข";break;case"te":t="ఇక్కడ రాయండి...",i="పంపండి",a="ఇది సంఖ్య అయ్యుండాలి";break;case"tr":t="Buraya yazın...",i="Gönder",a="Bu bir sayı olmalı";break;case"uk":t="Напишіть тут...",i="Надіслати",a="Це повинно бути число";break;case"vi":t="Viết vào đây...",i="Gửi",a="Đây phải là một số";break;case"zh":t="在此处写...",i="发送",a="这必须是一个数字"}$("#js_zona_slides").find("textarea, input").attr("placeholder",t),$(".js-zona-shadow-editor-slide").find("textarea, input").attr("placeholder",t),$(".js-boton-submit-form").html(`${i}<i class="far fa-paper-plane mlx-2"></i>`),u.setInputFilter($('input[type="tel"]'),(function(e){return/^-?\d*$/.test(e)}),a)}static habilitarCheckbox(e){const t=$(e.currentTarget).closest("form").find(".js-boton-dependiente-checkbox"),i=$(e.currentTarget).closest("form").find(".js-checkbox-deshabilita-boton");$(e.currentTarget).closest("form").find(".js-checkbox-deshabilita-boton:checked").length==i.length?t.prop("disabled",!1):t.prop("disabled",!0)}static pasarCardFinal(){const e=$(".js-slide-frontend .js-contenido-final .js-card-final.js-card-activa"),t=e.next();t.length>0&&(e.removeClass("js-card-activa animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("js-pasada animate__animated animate__fadeOutLeft").hide(),t.removeClass("animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("animate__animated animate__fadeInRight js-card-activa").show())}static previousCardFinal(){const e=$(".js-slide-frontend .js-contenido-final .js-card-final.js-card-activa"),t=e.prev(".js-card-final");t.length>0&&(e.removeClass("js-card-activa animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("animate__animated animate__fadeOutRight").hide(),t.removeClass("js-pasada animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("animate__animated animate__fadeInLeft js-card-activa").show())}static pasarCardFinalElemento(e){const t=$(e.target).closest(".js-contenido-final").find(".js-card-final.js-card-activa"),i=t.next();i.length>0&&(t.removeClass("js-card-activa animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("js-pasada animate__animated animate__fadeOutLeft").hide(),i.removeClass("animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("animate__animated animate__fadeInRight js-card-activa").show())}static previousCardFinalElemento(e){const t=$(e.target).closest(".js-contenido-final").find(".js-card-final.js-card-activa"),i=t.prev();i.length>0&&(t.removeClass("js-card-activa animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("animate__animated animate__fadeOutRight").hide(),i.removeClass("js-pasada animate__fadeOutRight animate__fadeInLeft animate__fadeInRight animate__fadeOutLeft").addClass("animate__animated animate__fadeInLeft js-card-activa").show())}static setInputFilter(e,t,i){["input","keydown","keyup","mousedown","mouseup","select","contextmenu","drop","focusout"].forEach((function(a){e.on(a,(function(e){t(this.value)?(["keydown","mousedown","focusout"].indexOf(e.type)>=0&&(this.classList.remove("input-error"),this.setCustomValidity("")),this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.classList.add("input-error"),this.setCustomValidity(i),this.reportValidity(),this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""}))}))}}class h extends n{constructor(e,t){super(e,t),u.previewImage(),r.cargaLibreria("Autosize");const i=this.kite.language.split("-")[0];u.cambiaPlaceholders(i),this.botones={},this.createFuncionalidadesAntiguas()}activateEspecifico(){for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadesAntiguas(){const e=this;for(const t of Object.values(this.slideInfo.objetoBlobSlide.botones||{})){const i=new l(e.kite,t.id_boton,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_elemento='${t.id_boton}']`),this.botones[t.id_boton]=i}}activateListenersEspecifico(){$(".js-form-formulario-vertical").on("submit",(e=>{const t=this;if(e.preventDefault(),this.kite.preventDoubleClick(e))return;u.pasarCardFinal(),t.slideDivJQuery.removeClass("swiper-no-swiping"),t.slideInfo.objetoBlobSlide.navegacion=t.slideInfo.objetoBlobSlide.navegacion||{},t.slideInfo.objetoBlobSlide.navegacion.bloqueo_avance="";const i=new FormData(e.target),a=this.kite.idKite||document.body.dataset.idorigen,s=this.kite.kiteInfo.host.replace("//","//upload.");$.ajax({url:`${s}/formulario_vertical/${a}`,type:"POST",data:i,cache:!1,contentType:!1,processData:!1,success:function(e){},error:function(e){}})})),$(".js-checkbox-deshabilita-boton").on("change",(e=>{u.habilitarCheckbox(e)})),$(".js-form-estrella").on("click",(e=>{const t=$(e.target).attr("data-value");$(e.target).closest(".js-form-valoracion").find(".js-form-valoracion-resultado").val(t)}));for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){$(".js-form-formulario-vertical").off(),$(".js-checkbox-deshabilita-boton").off(),$(".js-form-estrella").off();for(const e of Object.values(this.botones))e.divListener.off()}}class p extends n{constructor(e,t){super(e,t),this.botones={},this.createFuncionalidadesAntiguas()}activateEspecifico(){for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadesAntiguas(){const e=this;for(const t of Object.values(this.slideInfo.objetoBlobSlide.secciones||{})){const i=new l(e.kite,t.id_seccion,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_elemento='${t.id_seccion}']`),this.botones[t.id_seccion]=i}}activateListenersEspecifico(){for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){for(const e of Object.values(this.botones))e.divListener.off()}}class f extends n{constructor(e,t){super(e,t),this.botones={},this.createFuncionalidadesAntiguas()}activateEspecifico(){for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadesAntiguas(){const e=this;for(const t of Object.values(this.slideInfo.objetoBlobSlide.secciones||{}))for(const i of Object.values(t.tarjetas||{})){const t=new l(e.kite,i.id_tarjeta,this.idSlide,i.funcionalidad);t.divListener=$(`.js-boton-funcionalidad[data-id_elemento='${i.id_tarjeta}']`),this.botones[i.id_tarjeta]=t}}activateListenersEspecifico(){for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){for(const e of Object.values(this.botones))e.divListener.off()}}class m{constructor(e,t){this.slide=t,this.kite=this.slide.kite,this.idSlide=this.slide.idSlide,this.elementInfo=e,this.idElemento=this.elementInfo.id_elemento,this.activated=!1,this.firstTime=!1,this.elementDivJQuery=this.slide.slideDivJQuery.find(`.js-elemento-libre[data-id_elemento='${this.idElemento}']`),this.funcionalidad=!1,this.createCssAnimationElement(),this.scaleElement()}scaleElement(){const e=this,t=this.elementInfo.tipo;let i=1;if(i="frontend"==this.kite.context?e.kite.scale:document.documentElement.style.getPropertyValue("--scale"),["mapa"].indexOf(t)>=0)if("frontend"==this.kite.context){const t=e.elementInfo.style.width_px?parseFloat(e.elementInfo.style.width_px):parseFloat(450*e.elementInfo.style.width/100),a=e.elementInfo.style.height_px?parseFloat(e.elementInfo.style.height_px):parseFloat(450*e.elementInfo.style.height/100),s=e.elementInfo.style.top_px?parseFloat(e.elementInfo.style.top_px):parseFloat(800*e.elementInfo.style.top/100),o=e.elementInfo.style.left_px?parseFloat(e.elementInfo.style.left_px):parseFloat(450*e.elementInfo.style.left/100);e.elementDivJQuery.css("width",t*i),e.elementDivJQuery.css("height",a*i),e.elementDivJQuery.css("top",s-a*(i-1)/2),e.elementDivJQuery.css("left",o-t*(i-1)/2),e.elementDivJQuery.css("transform",`scale(${1/i})`)}else{const t=$(`#js_zona_mapa_elemento_${e.idSlide}_${e.idElemento}`),a=e.elementInfo.style.width_px?parseFloat(e.elementInfo.style.width_px):parseFloat(450*e.elementInfo.style.width/100),s=e.elementInfo.style.height_px?parseFloat(e.elementInfo.style.height_px):parseFloat(450*e.elementInfo.style.height/100);t.css("width",a*i),t.css("height",s*i),t.css("transform-origin","left"),t.css("transform",`scale(${1/i})`)}}activate(){this.activated=!0,this.activateListeners(),this.activateEspecifico(),this.animadoElElemento=!1}activateEspecifico(){}deactivate(){this.activated=!1,this.deactivateListeners(),this.deactivateEspecifico(),"frontend"==this.kite.context&&this.deactivateAnimations()}deactivateEspecifico(){}activateListeners(){this.activateListenersEspecifico(),$(window).on("resize",(()=>{this.scaleElement()})),"frontend"==this.kite.context&&(this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&!this.animadoElElemento&&(this.activateAnimations(),this.animadoElElemento=!0)}))})),this.observer.observe(this.elementDivJQuery[0]))}activateListenersEspecifico(){}deactivateListeners(){this.deactivateListenersEspecifico(),$(window).off("resize",(()=>{this.scaleElement()})),$(document).off("resizeElementMapa",(()=>{this.scaleElement()})),"frontend"==this.kite.context&&this.observer&&this.observer.unobserve(this.elementDivJQuery[0])}deactivateListenersEspecifico(){}createCssAnimationElement(){const e={};this.elementInfo?.animation?.animation&&Object.assign(e,{animation:this.elementInfo?.animation?.animation}),this.elementInfo?.animation?.duration?Object.assign(e,{"animation-duration":this.elementInfo?.animation?.duration+"s"}):Object.assign(e,{"animation-duration":"1s"}),this.elementInfo?.animation?.repeat&&Object.assign(e,{"animation-iteration-count":this.elementInfo?.animation?.repeat});const t=Object.entries(e).map((([e,t])=>`${e}:${t}`)).join("; "),i=`.css-animation-${this.idSlide}-${this.idElemento} {\n            ${t}\n        }`;$("#js_estilo_elementos")[0].append(i),"frontend"==this.kite.context&&(this.elementInfo?.animation?.animation?.indexOf("In")>=0?this.elementDivJQuery.css("opacity",0):this.elementDivJQuery.css("opacity",1))}activateAnimations(){this.elementInfo?.animation?.animation?.indexOf("In")>=0?this.elementDivJQuery.css("opacity",0):this.elementDivJQuery.css("opacity",1),setTimeout((()=>{this.elementDivJQuery.css("opacity",1),this.elementDivJQuery.addClass(`css-animation-${this.idSlide}-${this.idElemento}`)}),1e3*this.elementInfo?.animation?.delay)}deactivateAnimations(){this.elementDivJQuery.removeClass(`css-animation-${this.idSlide}-${this.idElemento}`)}}class v extends m{constructor(e,t){super(e,t),this.funcionalidad=new l(this.slide.kite,this.elementInfo.id_elemento,this.slide.idSlide,this.elementInfo.funcionalidad),this.elementInfo.style.tipografia&&s(this.elementInfo,this.elementDivJQuery,this.kite.cdn)}activateEspecifico(){this.funcionalidad.activate()}deactivateEspecifico(){this.funcionalidad.deactivate()}activateListenersEspecifico(){this.funcionalidad.divListener.on("click",(()=>{this.funcionalidad.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){this.funcionalidad.divListener.off()}}class b extends m{constructor(e,t){super(e,t),this.funcionalidad=new l(this.slide.kite,this.elementInfo.id_elemento,this.slide.idSlide,this.elementInfo.funcionalidad),this.elementInfo.style.tipografia&&s(this.elementInfo,this.elementDivJQuery,this.kite.cdn)}activateEspecifico(){this.funcionalidad.activate()}deactivateEspecifico(){this.funcionalidad.deactivate()}activateListenersEspecifico(){this.funcionalidad.divListener.on("click",(()=>{this.funcionalidad.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){this.funcionalidad.divListener.off()}}class g extends m{constructor(e,t){super(e,t),this.funcionalidad=new l(this.slide.kite,this.elementInfo.id_elemento,this.slide.idSlide,this.elementInfo.funcionalidad)}activateEspecifico(){this.funcionalidad.activate()}deactivateEspecifico(){this.funcionalidad.deactivate()}activateListenersEspecifico(){this.funcionalidad.divListener.on("click",(()=>{this.funcionalidad.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){this.funcionalidad.divListener.off()}}class y extends m{constructor(e,t){super(e,t),this.funcionalidad=new l(this.slide.kite,this.elementInfo.id_elemento,this.slide.idSlide,this.elementInfo.funcionalidad)}activateEspecifico(){this.funcionalidad.activate()}deactivateEspecifico(){this.funcionalidad.deactivate()}activateListenersEspecifico(){this.funcionalidad.divListener.on("click",(()=>{this.funcionalidad.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){this.funcionalidad.divListener.off()}}class _ extends m{constructor(e,t){super(e,t),this.playerAudio=document.querySelector("#player_audio_"+this.slide.idSlide+"_"+this.idElemento)}activateEspecifico(){}deactivateEspecifico(){this.pausarAudio()}cargaAudio(){}pausarAudio(){this.playerAudio&&(this.playerAudio.pause(),this.playerAudio.currentTime=0)}}class k extends m{constructor(e,t){super(e,t),u.previewImage();const i=this.kite.language.split("-")[0];u.cambiaPlaceholders(i),u.checkSizeImage(25),r.cargaLibreria("Autosize"),this.botones={},this.createFuncionalidadBotones()}activateEspecifico(){for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadBotones(){const e=this.slide;for(const t of Object.values(this.elementInfo.botones||{})){const i=new l(e.kite,t.id_boton,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_slide='${this.idSlide}'][data-id_elemento='${t.id_boton}']`),this.botones[t.id_boton]=i}}activateListenersEspecifico(){$(".js-form-formulario-elemento").on("submit",(e=>{if(e.preventDefault(),this.kite.preventDoubleClick(e))return;this.elementInfo.data?.lead_directo||u.pasarCardFinalElemento(e);const t=new FormData(e.target),i=this.kite.kiteInfo.host.replace("//","//upload."),a={category:"click",action:"submit form",label:this.idElemento,slideId:this.idSlide};this.kite.analytics.sendEvent(a);const s=this.kite.idKite||document.body.dataset.idorigen,o=this.elementInfo,n=this.botones;$.ajax({url:`${i}/formulario_vertical/${s}`,type:"POST",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){if(o.data?.lead_directo)for(const e of Object.values(n))e.ejecutarFuncionalidad()},error:function(e){}})})),$(".js-checkbox-deshabilita-boton").on("change",(e=>{u.habilitarCheckbox(e)})),$(".js-form-estrella").on("click",(e=>{const t=$(e.target).closest(".js-estrellas-rating"),i=$(e.target).closest(".js-form-estrella").attr("data-value");t.find(".js-form-estrella").removeClass("active");const a=t.find(".js-form-estrella");for(let e=0;e<i;e++)$(a[e]).addClass("active");$(e.target).closest(".js-form-valoracion").find(".js-form-valoracion-resultado").val(i)}));for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){$(".js-form-formulario-elemento").off(),$(".js-checkbox-deshabilita-boton").off(),$(".js-form-estrella").off();for(const e of Object.values(this.botones))e.divListener.off()}}class w extends m{constructor(e,t){super(e,t),this.map=void 0,this.bounds={},this.max_zoom=void 0,this.padding={},this.mapasElemento={},this.botones={},this.loading=!1,"frontend"==this.kite.context?this.promesa=void 0:this.promesa=this.cargaMapa(),this.id=this.slide.idSlide,document.addEventListener("mapCharge",(e=>{e.detail.slide.idSlide==this.slide.idSlide&&e.detail.slide.loading&&(this.promesa=this.cargaMapa())}))}async activateEspecifico(){await this.promesa,this.map.resize(),this.bounds._sw&&this.map.fitBounds(this.bounds,{duration:0,maxZoom:this.max_zoom,padding:this.padding});for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadMarkers(){const e=this.slide;for(const t of Object.values(this.elementInfo.botones||{})){const i=new l(e.kite,t.id_boton,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_slide='${this.idSlide}'][data-id_elemento='${t.id_marker}']`),i.datosBoton=t,this.botones[t.id_marker]=i}}async activateListenersEspecifico(){await this.promesa;const e=this;for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{const t=e.datosBoton,i=t.fly_zoom,a=t.fly_duration,s=this.map.getZoom(),o=i||s,n=a||0;this.map.flyTo({center:n?t.coordenadas:void 0,curve:1,zoom:o,duration:n,speed:.8,essential:!0}),setTimeout((()=>{e.divListener.find(".js-punto-no-leido").hide(),e.ejecutarFuncionalidad()}),a)}));let t=0,i=0,a=0,s=0,o=0,n=0;this.start=function(e){t=e.originalEvent.touches[0].clientX,i=e.originalEvent.touches[0].clientY,o=0,n=0,a=Date.now()},this.move=function(e){const a=e.originalEvent.touches[0].clientX,s=e.originalEvent.touches[0].clientY;o=a-t,n=s-i},this.end=function(t){s=Date.now();const i=s-a;"vertical"===e.kite.navigation&&i<200&&Math.abs(n)>Math.abs(o)&&e.kite.swiper.slideTo(e.kite.swiper.activeIndex+(n<0?1:-1)),("horizontal"===e.kite.navigation||"story"===e.kite.navigation)&&i<200&&Math.abs(o)>Math.abs(n)&&e.kite.swiper.slideTo(e.kite.swiper.activeIndex+(o<0?1:-1))},this.mouseStartDrag=function(t){e.kite.swiper.allowTouchMove=!1},this.mouseEndDrag=function(t){e.kite.swiper.allowTouchMove=!0},this.map.on("touchstart",this.start),this.map.on("touchmove",this.move),this.map.on("touchend",this.end),this.map.on("mousedown",this.mouseStartDrag),this.map.on("mouseup",this.mouseEndDrag),this.resetMapa=function(){e.scaleElement(),e.map.resize()},$(document).off("resizeElementMapa"),$(document).on("resizeElementMapa",this.resetMapa)}deactivateListenersEspecifico(){this.map.off("touchstart",this.start),this.map.off("touchmove",this.move),this.map.off("touchend",this.end),this.map.off("mousedown",this.mouseStartDrag),this.map.off("mouseup",this.mouseEndDrag);for(const e of Object.values(this.botones))e.divListener.off()}async cargaMapa(){return new Promise(((e,t)=>{if("frontend"==this.kite.context)w.mapboxLoaded?(this.chargingMap(),e("Mapa hecho")):(r.cargaLibreria("Mapbox"),$(document).on("mapboxLoaded",(async()=>{const t=this.elementInfo,i=t.data.estilo_mapa||"mapbox://styles/origenio/cko9m78rl5kmc17qhlc1crqlp";this.max_zoom=t.data.max_zoom||7;const a=`js_zona_mapa_elemento_${this.idSlide}_${this.idElemento}`;mapboxgl.accessToken=this.kite.kiteInfo.mapboxtoken;const s=new mapboxgl.Map({container:a,style:i+"?optimize=true"});this.map=s,this.esperaCarga=s.on("load",(function(){})),s.on("dataloading",(function(){})),await this.cargaMapaElemento(),this.createFuncionalidadMarkers(),w.mapboxLoaded=!0,e("Mapa hecho")})));else{const t=this.elementInfo,i=t.data.estilo_mapa||"mapbox://styles/origenio/cko9m78rl5kmc17qhlc1crqlp";this.max_zoom=t.data.max_zoom||7;const a=`js_zona_mapa_elemento_${this.idSlide}_${this.idElemento}`;mapboxgl.accessToken=mapboxtoken;const s=new mapboxgl.Map({container:a,style:i+"?optimize=true"});this.map=s,this.esperaCarga=s.on("load",(function(){})),s.on("dataloading",(function(){})),this.cargaMapaElemento(),this.createFuncionalidadMarkers(),e("Mapa hecho")}}))}async chargingMap(){const e=this.elementInfo,t=e.data.estilo_mapa||"mapbox://styles/origenio/cko9m78rl5kmc17qhlc1crqlp";this.max_zoom=e.data.max_zoom||7;const i=`js_zona_mapa_elemento_${this.idSlide}_${this.idElemento}`;mapboxgl.accessToken=this.kite.kiteInfo.mapboxtoken;const a=new mapboxgl.Map({container:i,style:t+"?optimize=true"});this.map=a,this.esperaCarga=a.on("load",(function(){})),a.on("dataloading",(function(){})),await this.cargaMapaElemento(),this.createFuncionalidadMarkers()}async cargaMapaElemento(){return new Promise(((e,t)=>{const i=this;i.map.on("load",(()=>{const t=this.elementInfo.botones;if(t){i.bounds=new mapboxgl.LngLatBounds;let e=0,a=0;for(const s in t){i.bounds.extend(t[s].coordenadas);const o=document.createElement("div");o.className="fe-marker-elemento animacion js-boton-funcionalidad js-marker-pulsable-elemento",o.dataset.ga_category="slideEvent",o.dataset.ga_action="idMarker:"+t[s].id_marker,o.dataset.ga_label="Click en marker",o.dataset.ga_value="",o.dataset.id_slide=this.idSlide,o.dataset.id_elemento=t[s].id_marker;const n=document.createElement("div");n.className="punto-no-leido js-punto-no-leido",n.style.display="block",o.appendChild(n);const r=this.kite.kiteInfo.cdn||"https://static.qrkit.es";o.style.backgroundImage=`url('${r}/${t[s].image_marker}')`;new mapboxgl.Marker(o,{anchor:"bottom"}).setLngLat(t[s].coordenadas).addTo(i.map);e=o.offsetWidth||0,a=o.offsetHeight||0}i.padding={top:a+5,bottom:5,left:e/2+5,right:e/2+5},i.map.resize(),i.map.fitBounds(i.bounds,{duration:0,maxZoom:i.max_zoom,padding:i.padding})}e()}))}))}}w.mapboxLoaded=!1;class S extends m{constructor(e,t){super(e,t),this.botones={},this.createFuncionalidadBotones()}activateEspecifico(){for(const e of Object.values(this.botones))e.activate()}deactivateEspecifico(){for(const e of Object.values(this.botones))e.deactivate()}createFuncionalidadBotones(){const e=this.slide;for(const t of Object.values(this.elementInfo.botones||{})){const i=new l(e.kite,t.id_boton,this.idSlide,t.funcionalidad);i.divListener=$(`.js-boton-funcionalidad[data-id_slide='${this.idSlide}'][data-id_elemento='${t.id_boton}']`),this.botones[t.id_boton]=i}}activateListenersEspecifico(){$(".js-star-valoracion-elemento").on("click",(e=>{if(this.kite.preventDoubleClick(e))return;const t=$(e.target).closest(".js-form-slide-valoracion-elemento")[0].dataset.owner,i=$(e.target).closest(".js-form-slide-valoracion-elemento")[0].dataset.idorigen,a=$(e.target).closest(".js-form-slide-valoracion-elemento")[0].dataset.idslide,s=$(e.target).closest(".js-form-slide-valoracion-elemento")[0].dataset.idelemento,o=$(e.target).closest(".js-form-slide-valoracion-elemento")[0].dataset.idpregunta,n=$(e.target).closest(".js-form-slide-valoracion-elemento")[0].dataset.titulopregunta,r=$(e.target)[0].dataset.value,l=new FormData;l.append("owner",t),l.append("id_origen",i),l.append("id_slide",a),l.append("id_elemento",s),l.append(`${o}_${n}`,r),$(e.target).addClass("star-selected"),setTimeout((()=>{u.pasarCardFinalElemento(e)}),500);const c={category:"click",action:"submit rating",label:this.idElemento,slideId:this.idSlide};this.kite.analytics.sendEvent(c);const d=this.kite.kiteInfo.host.replace("//","//upload."),h=this.kite.idKite||document.body.dataset.idorigen;$.ajax({url:`${d}/formulario_vertical/${h}`,type:"POST",data:l,cache:!1,contentType:!1,processData:!1,success:function(e){},error:function(e){}})}));for(const e of Object.values(this.botones))e.divListener.on("click",(()=>{e.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){$(".js-star-valoracion-elemento").off();for(const e of Object.values(this.botones))e.divListener.off()}}class j extends m{constructor(e,t){super(e,t)}activateEspecifico(){this.firstTime||(this.firstTime=!0,r.cargaLibreria("Typeform"))}}class E extends m{constructor(e,t){super(e,t)}activateEspecifico(){}}class x extends m{constructor(e,t){super(e,t)}activateEspecifico(){}}class I extends m{constructor(e,t){super(e,t),this.playerVideo=document.querySelector("#player_video_"+this.idSlide+"_"+this.idElemento)}activateEspecifico(){this.elementInfo.data.autoplay&&(this.iniciaVideo(),this.activarSonidoVideo())}deactivateEspecifico(){this.pausarVideo()}iniciaVideo(){this.playerVideo&&this.playerVideo.play()}pausarVideo(){this.playerVideo&&(this.playerVideo.pause(),this.playerVideo.currentTime=0)}activarSonidoVideo(){"frontend"==this.kite.context&&this.elementInfo.data.muted&&navigator?.userActivation?.isActive&&(this.playerVideo.muted=!1)}}class F extends m{constructor(e,t){super(e,t),this.playerYoutube=$("#player_youtube_"+this.idSlide+"_"+this.idElemento),this.srcVideo=this.playerYoutube.attr("src")}activateEspecifico(){}deactivateEspecifico(){}}class C extends m{constructor(e,t){super(e,t),this.funcionalidad=new l(this.slide.kite,this.elementInfo.id_elemento,this.slide.idSlide,this.elementInfo.funcionalidad)}activateEspecifico(){this.funcionalidad.activate()}deactivateEspecifico(){this.funcionalidad.deactivate()}activateListenersEspecifico(){this.funcionalidad.divListener.on("click",(()=>{this.funcionalidad.ejecutarFuncionalidad()}))}deactivateListenersEspecifico(){this.funcionalidad.divListener.off()}}class L extends m{constructor(e,t){super(e,t),this.iframeJs=this.elementDivJQuery.find("iframe"),this.promesa=this.cargaIframe()}async cargaIframe(){return new Promise(((e,t)=>{this.iframeJs.on("load",(()=>{e("iframe cargado")}))}))}async activateListenersEspecifico(){await this.promesa,this.iframe=this.elementDivJQuery.find("iframe").contents().find("html");const e=this;let t=0,i=0,a=0,s=0,o=0,n=0;this.start=function(e){t=e.originalEvent.touches[0].clientX,i=e.originalEvent.touches[0].clientY,o=0,n=0,a=Date.now()},this.move=function(e){const a=e.originalEvent.touches[0].clientX,s=e.originalEvent.touches[0].clientY;o=a-t,n=s-i},this.end=function(t){s=Date.now();const i=s-a;"vertical"===e.kite.navigation&&i<200&&Math.abs(n)>Math.abs(o)&&e.kite.swiper.slideTo(e.kite.swiper.activeIndex+(n<0?1:-1)),("horizontal"===e.kite.navigation||"story"===e.kite.navigation)&&i<200&&Math.abs(o)>Math.abs(n)&&e.kite.swiper.slideTo(e.kite.swiper.activeIndex+(o<0?1:-1))},this.iframe.on("touchstart",this.start),this.iframe.on("touchmove",this.move),this.iframe.on("touchend",this.end)}deactivateListenersEspecifico(){this.iframe?.off("touchstart",this.start),this.iframe?.off("touchmove",this.move),this.iframe?.off("touchend",this.end)}}class T extends m{constructor(e,t){super(e,t)}async activateListenersEspecifico(){}deactivateListenersEspecifico(){}}class D extends m{constructor(e,t){super(e,t),this.playerVimeo=$("#player_vimeo_"+this.idSlide+"_"+this.idElemento),this.srcVideo=this.playerVimeo.attr("src")}activateEspecifico(){}deactivateEspecifico(){this.playerVimeo[0].contentWindow.postMessage('{"method":"pause"}',"*")}}class P extends m{constructor(e,t){super(e,t),this.init()}async init(){try{this.kite.customcoderequested=await this.kite.requestCustomCode(),this.customcode=this.kite.kiteInfo.customcode?.[this.idSlide]?.[this.idElemento]||{},"http:"===window.location.protocol?this.insertarCodigoConIframe():window.location.hostname.includes(".qrkit.es")?this.insertarCodigoSinIframe():"qrkit.es"===window.location.hostname&&window.location.pathname.includes("/vistaprevia/")||window.location.hostname.includes("qrkit.es")||window.location.hostname.includes("admin.origen.link")||window.location.hostname.includes("admin.makekites.io")||window.location.hostname.includes("admin.kites.io")?this.insertarCodigoConIframe():this.insertarCodigoSinIframe()}catch(e){throw e}}insertarCodigoConIframe(){try{const e=this.elementDivJQuery.find(".js-elemento-iframe-encapsulado")[0],t=document.createElement("iframe");t.setAttribute("frameborder","0"),t.style.width="100%",t.style.height="100%",e.appendChild(t);const i=t.contentDocument||t.contentWindow.document;if(this.customcode.html=this.customcode.html||"",i.open(),i.write(`<html><head></head><body>${this.customcode.html}</body></html>`),this.customcode.css){const e=i.createElement("style");e.innerHTML=this.customcode.css,i.head.appendChild(e)}if(this.customcode.js){const e=i.createElement("script");e.innerHTML=`try { ${this.customcode.js} } catch (e) {console.error(e)}`,i.body.appendChild(e)}i.close()}catch(e){}}insertarCodigoSinIframe(){try{const e=this.elementDivJQuery.find(".js-elemento-iframe-encapsulado")[0],t=document.createElement("div");if(t.style.width="100%",t.style.height="100%",t.innerHTML=this.customcode.html||"",e.appendChild(t),$(e).find("script").each((function(){if($(this).attr("src")){const t=document.createElement("script");for(let e=0;e<this.attributes.length;e++){const i=this.attributes[e];t[i.name]=i.value}$(this).remove(),e.appendChild(t)}})),this.customcode.js){const t=document.createElement("script");t.innerHTML=`try { ${this.customcode.js} } catch (e) {console.error(e)}`,e.append(t)}this.customcode.css&&$("#js_estilo_elementos")[0].append(this.customcode.css)}catch(e){}}activateEspecifico(){}deactivateEspecifico(){}}class z extends m{constructor(e,t){super(e,t)}activateEspecifico(){"frontend"==this.kite.context&&this.funcionalidadDescargaApp()}getMobileOperatingSystem(){const e=navigator?.userAgent||navigator?.vendor||window.opera;return/android/i.test(e)?"android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"ios":void 0}funcionalidadDescargaApp(){const e=this.getMobileOperatingSystem();"automatica"==this.elementInfo.data.funcionalidad_slide?"android"==e?window.open(this.elementInfo.data.url_google_play,"_self"):"ios"==e?window.open(this.elementInfo.data.url_apple_store,"_self"):window.open("https://kites.io","_self"):"android"==e?$(".js-boton-appstore-ios").hide():"ios"==e&&$(".js-boton-appstore-android").hide()}}class O extends m{activateListenersEspecifico(){$(".js-form-formulario-lock-elemento").on("submit",(e=>{if(e.preventDefault(),this.kite.preventDoubleClick(e))return;const t=new FormData(e.target),i={};for(const e of t)i[e[0]]=e[1];i.url=window.location.href,$.ajax({type:"POST",url:"/passlogin",data:JSON.stringify(i),cache:!1,contentType:"application/json",processData:!1,success:function(e){window.location.href=e||window.location.href},error:function(t){u.pasarCardFinalElemento(e)}})})),$(".js-try-again").on("click",(e=>{e.preventDefault(),this.kite.preventDoubleClick(e)||u.previousCardFinalElemento(e)}))}deactivateListenersEspecifico(){$(".js-form-formulario-elemento").off(),$(".js-try-again").off()}}class B extends m{constructor(e,t){super(e,t),this.elementInfo.style.tipografia&&s(this.elementInfo,this.elementDivJQuery,this.kite.cdn),"freeform_text"==this.elementInfo.tipo&&r.cargaLibreria("Autosize"),"freeform_upload"==this.elementInfo.tipo&&(u.checkSizeImage(45),u.previewImage())}activateEspecifico(){}deactivateEspecifico(){}activateListenersEspecifico(){this.elementDivJQuery.find(".js-freeform-element").on("focusout",(e=>{$(e.target)[0].reportValidity()})),"freeform_valuation"==this.elementInfo.tipo&&$(".js-form-estrella").on("click",(e=>{const t=$(e.target).closest(".js-estrellas-rating"),i=$(e.target).closest(".js-form-estrella").attr("data-value");t.find(".js-form-estrella").removeClass("active");const a=t.find(".js-form-estrella");for(let e=0;e<i;e++)$(a[e]).addClass("active");$(e.target).closest(".js-form-valoracion").find(".js-form-valoracion-resultado").val(i)}))}deactivateListenersEspecifico(){this.elementDivJQuery.find(".js-freeform-element").off(),"freeform_valuation"==this.elementInfo.tipo&&$(".js-form-estrella").off()}}class A{static createElementKites(e,t){const i={texto:function(e){return new v(e,t)},boton:function(e){return new b(e,t)},icono:function(e){return new g(e,t)},imagen:function(e){return new y(e,t)},audio:function(e){return new _(e,t)},formulario:function(e){return new k(e,t)},mapa:function(e){return new w(e,t)},spotify:function(e){return new m(e,t)},valoracion:function(e){return new S(e,t)},google_form:function(e){return new m(e,t)},typeform:function(e){return new j(e,t)},formaloo:function(e){return new E(e,t)},jotform:function(e){return new x(e,t)},video:function(e){return new I(e,t)},youtube:function(e){return new F(e,t)},area:function(e){return new C(e,t)},insert_kite:function(e){return new L(e,t)},iframe:function(e){return new T(e,t)},vimeo:function(e){return new D(e,t)},custom:function(e){return new P(e,t)},download_app:function(e){return new z(e,t)},form_lock:function(e){return new O(e,t)},embed:function(e){return new m(e,t)},freeform_text:function(e){return new B(e,t)},freeform_upload:function(e){return new B(e,t)},freeform_email:function(e){return new B(e,t)},freeform_telephone:function(e){return new B(e,t)},freeform_date:function(e){return new B(e,t)},freeform_checkbox:function(e){return new B(e,t)},freeform_valuation:function(e){return new B(e,t)},freeform_select:function(e){return new B(e,t)}};return i[e.tipo](e)}}class G extends n{constructor(e,t){super(e,t),this.elementos={},this.createAllElements(),"video"==this.slideInfo.objetoBlobSlide.fondo.tipo&&(this.playerFullscreen=document.querySelector("#player_fullscreen_"+this.idSlide))}addElement(e){const t=A.createElementKites(e,this);this.elementos[e.id_elemento]=t}removeElement(e){this.elementos[e].deactivate(),delete this.elementos[e]}updateElement(e){this.removeElement(e.id_elemento),this.addElement(e),this.elementos[e.id_elemento].activate()}createAllElements(){if(this.slideInfo.objetoBlobSlide.elementos)for(const e of Object.values(this.slideInfo.objetoBlobSlide.elementos||{}))try{if(!e?.id_elemento)continue;this.addElement(e)}catch(e){}}activateEspecifico(){for(const e of Object.values(this.elementos))e.activate();"video"===this.slideInfo.objetoBlobSlide.fondo.tipo&&this.activarVideo()}deactivateEspecifico(){for(const e of Object.values(this.elementos))e.deactivate();"video"===this.slideInfo.objetoBlobSlide.fondo.tipo&&this.pausarVideoPrevio()}activarVideo(){if(!this.playerFullscreen)return;const e=this.slideInfo.objetoBlobSlide.fondo.video.final,t=this.slideInfo.objetoBlobSlide.fondo.video.sonido,i=this.slideInfo.objetoBlobSlide.fondo.video.loop;"next-slide"===e?(this.activarVideoNoBucle(),this.pasarSlideAlTerminarVideo()):i?this.activarVideoNoBucle():this.activarVideoEnBucle(),"no"===t||this.activarSonidoVideo()}activarVideoEnBucle(){this.playerFullscreen&&(this.playerFullscreen.loop=!0,this.playerFullscreen.play(),this.slideDivJQuery.find(".js-boton-play-video").removeClass("active"))}activarVideoNoBucle(){this.playerFullscreen&&(this.playerFullscreen.loop=!1,this.playerFullscreen.play(),this.slideDivJQuery.find(".js-boton-play-video").removeClass("active"))}activarSonidoVideo(){"frontend"===this.kite.context&&this.playerFullscreen.muted&&navigator?.userActivation?.hasBeenActive&&this.slideDivJQuery.find(".js-boton-silencio-video")[0].click()}pausarVideoPrevio(){this.playerFullscreen&&(this.playerFullscreen.pause(),this.playerFullscreen.currentTime=0)}pasarSlideAlTerminarVideo(){this.playerFullscreen&&(this.playerFullscreen.onended=()=>{this.kite.swiper.slideNext(),this.kite.indexStoryHistoryManager.addCurrentSlideToHistory()})}activateListenersEspecifico(){$(".js-boton-silencio-video").on("click",(e=>{this.playerFullscreen.muted?(this.playerFullscreen.muted=!1,$(e.currentTarget).addClass("active")):(this.playerFullscreen.muted=!0,$(e.currentTarget).removeClass("active"))})),$(".js-boton-play-video").on("click",(e=>{this.playerFullscreen.paused?(this.playerFullscreen.play(),$(e.currentTarget).removeClass("active")):(this.playerFullscreen.pause(),$(e.currentTarget).addClass("active"))})),$(".js-capa-pulsable").on("mousedown mouseup",(e=>{this.playerFullscreen&&("mousedown"===e.type?this.playerFullscreen.pause():this.playerFullscreen.play())})),$(".js-capa-pulsable").on("touchstart touchend",(e=>{this.playerFullscreen&&("touchstart"===e.type?this.playerFullscreen.pause():this.playerFullscreen.play())})),"video"==this.slideInfo.objetoBlobSlide.fondo.tipo&&(this.slideDivJQuery.on("openPopup",(()=>{this.playerFullscreen.pause()})),this.slideDivJQuery.on("closePopup",(()=>{this.playerFullscreen.play()})))}deactivateListenersEspecifico(){$(".js-boton-silencio-video").off(),$(".js-boton-play-video").off(),$(".js-capa-pulsable").off(),this.slideDivJQuery.off("openPopup"),this.slideDivJQuery.off("closePopup")}}class M{static createSlide(e,t){try{const i={video:function(e){return new c(e,t)},imagen:function(e){return new d(e,t)},redes_sociales:function(e){return new n(e,t)},formulario_vertical:function(e){return new h(e,t)},multilink:function(e){return new p(e,t)},classic:function(e){return new f(e,t)},libre:function(e){return new G(e,t)}};return i[e.tipo_slide](e,t)}catch(e){}}}class R{constructor(e){this.kite=e,this.sessionId=this.kite.kiteInfo.sessionId,"frontend"===this.kite.context&&(this.analyticsHost=this.kite.kiteInfo.host.replace("//","//analytics."),this.sessionStarted=Date.now(),this.owner=this.kite.kiteInfo.owner,this.i=0,setTimeout((()=>{this.sendEvent({category:"tictac",action:"none",slideId:"none"})}),4e3))}timer(){try{if(!this.sessionId)return;const e=Date.now()-this.sessionStarted;return Math.round(e/1e3)}catch(e){}}async sendEvent(e){try{if(!this.sessionId)return;if("frontend"!==this.kite.context)return;if(!(e&&e.category&&e.action&&e.slideId))return;e.duration=this.timer(),e.sessionId=this.sessionId,e.owner=this.owner,this.send(e,"event")}catch(e){}}async sendEventGA4(e="",t="Undefined",i={}){try{function a(){dataLayer.push(arguments)}const s={event_category:"click",event_action:e,kites_element_id:t};Object.assign(s,i),a("event","click_kites_element",s)}catch(o){}}send(e,t){try{$.ajax({url:`${this.analyticsHost}/${t}`,data:JSON.stringify(e),type:"POST",contentType:"application/json",cache:!1,success:function(e){},error:function(e){}})}catch(e){}}}function q(e){const t=!!e.analytics?.analytics_tag_manager,i=!!e.analytics?.analytics_ga,a=!!e.analytics?.analytics_fb,s=e?.analytics?.politica_cookies;let o={consent_modal:{layout:"bar",position:"bottom center",transition:"slide"},settings_modal:{layout:"box",transition:"slide"}};window.innerWidth>768&&(o={consent_modal:{layout:"box",position:"bottom left",transition:"slide"},settings_modal:{layout:"box",transition:"slide"}});const n=[],r={title:"Analytics cookies",description:"These cookies collect information about how you use the website, which pages you visited and which links you clicked on. All of the data is anonymized and cannot be used to identify you.",toggle:{value:"analytics",enabled:!1,readonly:!1}},l={title:"Advertising and profiling cookies",description:"Are those cookies aimed at tracking, monitoring, and analyzing how you browse and interact with the site and our services, as well as segment our users based on their behavior and how they browse the site, and to build audiences. They reveal usage trends as well as which users upgrade the services rendered by us and how is this done. All those actions are aimed at better understanding our users for improved communications and marketing strategies. You can opt to block or limit the installation and use of these cookies as explained on this banner and in our Cookie Policy, and this shall not impact the usability or functionalities of the site and/or the services.",toggle:{value:"marketing",enabled:!1,readonly:!1}},c={title:"More information",description:`For any queries in relation to our policy on cookies and your choices, please <a class="cc-link" href="${s}" target="_blank">visit</a>.`};n.push({title:"Cookie usage",description:"I use cookies to ensure the basic functionalities of the website and to enhance your online experience. You can choose for each category to opt-in/out whenever you want."}),t&&n.push(r),(i||a)&&n.push(l),n.push(c);const d=[],u={title:"Cookies analíticas",description:"Son aquellas cookies utilizadas para hacer seguimiento (tracking), monitoreo y análisis sobre cómo navegas e interactúas con el sitio y nuestros servicios, cuáles son las tendencias de uso de los mismos, y qué usuarios hacen un cambio de plan relativo a los servicios que prestamos y cómo realizan dicho cambio. Puedes optar por bloquear o limitar la instalación y uso de dichas cookies según se detalla en este banner y en nuestra Política de Cookies, y ello no debería impactar en la usabilidad o funcionalidad del sitio y/o los servicios.",toggle:{value:"analytics",enabled:!1,readonly:!1}},h={title:"Cookies de publicidad y marketing",description:"Son aquellas cookies utilizadas para hacer seguimiento (tracking), monitoreo y análisis sobre cómo navegas e interactúas con el Sitio y los servicios, así como para segmentar a nuestros usuarios con base en cómo navegan por el Sitio, y para crear audiencias. Sirven para revelar tendencias de uso del mismo, y qué usuarios hacen un cambio de plan relativo a los servicios que prestamos y cómo realizan dicho cambio. Todas estas acciones nos permiten conocer mejor a nuestros usuarios para mejorar nuestras comunicaciones y estrategias de marketing. Puedes optar por bloquear o limitar la instalación y uso de dichas cookies según se detalla en este banner y en nuestra Política de Cookies, y ello no debería impactar en la usabilidad o funcionalidad del Sitio y/o los servicios.",toggle:{value:"marketing",enabled:!1,readonly:!1}},p={title:"Más información",description:`Para cualquier consulta en relación con la política de cookies y su elección, por favor <a class="cc-link" href="${s}" target="_blank">visítenos</a>.`};d.push({title:"Uso de las cookies",description:"Usamos cookies para asegurar el correcto funcionamiento de la web y lograr la mejor experiencia posible. Ya que respetamos su derecho a la privacidad, usted puede escoger no permitirnos usar ciertas cookies."}),t&&d.push(u),(i||a)&&d.push(h),d.push(p);initCookieConsent().run({autorun:!0,delay:0,current_lang:"en",auto_language:"document",autoclear_cookies:!0,page_scripts:!0,gui_options:o,onFirstAction:function(e,t){},onAccept:function(e){},onChange:function(e,t){},languages:{en:{consent_modal:{title:"I use cookies 🍪",description:`Hi, this website uses essential cookies to ensure its proper operation and tracking cookies to understand how you interact with it. The latter will be set only upon approval. <a aria-label="Cookie policy" class="cc-link" href="${s}" target="_blank">Read more</a>`,primary_btn:{text:"Accept",role:"accept_all"},secondary_btn:{text:"Settings",role:"settings"}},settings_modal:{title:"Cookie preferences",save_settings_btn:"Save settings",accept_all_btn:"Accept all",reject_all_btn:"Reject all",blocks:n}},es:{consent_modal:{title:"Cookies 🍪",description:`Usamos cookies propias y de terceros para mostrarte contenidos más relevantes con base en tu historial de navegación. Puedes acceptar o gestionar la configuración sobre cookies más abajo. También puedes consultar nuestra <a aria-label="Cookie policy" class="cc-link" href="${s}" target="_blank">política de cookies</a>`,primary_btn:{text:"Aceptar todas las cookies",role:"accept_all"},secondary_btn:{text:"Configuración de cookies",role:"settings"}},settings_modal:{title:"Configuración de cookies",save_settings_btn:"Confirmar mis preferencias",accept_all_btn:"Aceptar todas",reject_all_btn:"Rechazar todas",blocks:d}}}})}window.kiteJS=class{constructor(i,s=null,n=null,l=null){if(this.context=i,this.idKite=s,this.currentKite=n,this.kiteInfo=this.objeto(),this.cdn=this.kiteInfo?.cdn||"",r.setCDN(this.cdn),this.timeStampGlobal=0,this.analytics=new R(this),this.customcoderequested=!1,this.slidesCharged=[],this.slidesWhatIHave=[],this.ancho=null,this.slides=[],this.language="en",this.getLanguage(),this.scale=1,"dashboard"==this.context)return this.createSlideInstanceConIdSlideDashboard(l),o.deshabilitarCosasParaElDashboard(),this.activateListeners(),void this.slides[0].activate();this.gestionTamanoScale(),this.createAllSlidesInstances(),this.currentSlide=$(".swiper-slide").first().attr("id_slide"),this.numeroSlidesNoOcultas=$("section.swiper-slide").length,o.ocultaBarraNavegacionUnaSlide(this.numeroSlidesNoOcultas),o.gestionDesktop(),o.evitaScrollCssFrontend(),a(this.kiteInfo),this.numeroSlidesNoOcultas<1?this.triggerKiteLoadedEvent():(this.cargaConfiguracionSwiper(),this.swiper=new Swiper(".swiper",this.configuracionSwiper),this.popupsSwiper=new e,this.activateListeners(),o.accionesDependientesDelIndexDeLaSlide(this.context,this.swiper),async function(e){const t=e.analytics?.cookie_banner,i=!!e.analytics?.analytics_tag_manager,a=!!e.analytics?.analytics_ga,s=!!e.analytics?.analytics_fb;if(!t||t&&!i&&!a&&!s)return!1;await r.cargaLibreria("CookieConsent"),"1"==e.presentacion?setTimeout((()=>{q(e)}),100):$(document).on("final_presentacion",(()=>{q(e)}))}(this.kiteInfo),this.chargeSlide(this.currentSlide),this.checkIfHaveToGoToSlideAtTheBeginning(),this.triggerKiteLoadedEvent(),this.gestionaOverflowDesktop(),$(document).on("final_presentacion",(()=>{this.findSlideInstanceFromIdSlide(this.currentSlide).activate(),this.indexStoryHistoryManager=new t(this)})))}triggerKiteLoadedEvent(){const e=new CustomEvent("kite_loaded",{detail:"Example of an event"});document.dispatchEvent(e)}cargaConfiguracionSwiper(){"vertical"===this.kiteInfo.deshabilitarnavegacionstory?this.navigation="vertical":"horizontal"===this.kiteInfo.deshabilitarnavegacionstory?this.navigation="horizontal":"true"===this.kiteInfo.deshabilitarnavegacionstory?this.navigation="botones":this.navigation="story","botones"==this.navigation?(o.cssNavegacionBotones(),this.tieneMousewheel=!1,this.configuracionSwiper={resistanceRatio:0,threshold:10,direction:"horizontal",touchStartPreventDefault:!1,allowTouchMove:!1,mousewheel:!1,lazy:!0}):"vertical"==this.navigation?(o.cssNavegacionVertical(),this.tieneMousewheel=!0,this.configuracionSwiper={resistanceRatio:0,threshold:10,direction:"vertical",touchStartPreventDefault:!1,allowTouchMove:!0,lazy:!0,mousewheel:{sensitivity:1,thresholdDelta:20},pagination:{el:".swiper-pagination",dynamicBullets:!0},keyboard:{enabled:!0}}):"horizontal"==this.navigation?(o.cssNavegacionHorizontal(),this.tieneMousewheel=!0,this.configuracionSwiper={resistanceRatio:0,threshold:10,direction:"horizontal",touchStartPreventDefault:!1,allowTouchMove:!0,lazy:!0,mousewheel:{sensitivity:1,thresholdDelta:20},pagination:{el:".swiper-pagination",dynamicBullets:!0},keyboard:{enabled:!0}}):(this.tieneMousewheel=!1,this.configuracionSwiper={resistanceRatio:0,threshold:10,direction:"horizontal",preloadImages:!1,touchStartPreventDefault:!1,allowTouchMove:!0,mousewheel:!1,lazy:!0})}checkIfHaveToGoToSlideAtTheBeginning(){const e=new Proxy(new URLSearchParams(window.location.search),{get:(e,t)=>e.get(t)});if(this.goTokiteSlide=e.slide?e.slide:null,this.goTokiteSlide){const e=parseInt(this.goTokiteSlide);if(0!==e&&e<=this.numeroSlidesNoOcultas){const e=this.slides[this.goTokiteSlide-1].idSlide;this.chargeSlide(e),this.swiper.slideTo(this.goTokiteSlide-1,0)}}}chargeSlide(e){const t=Number(e);if(!this.wasCharged(t)){this.makeEagerTheLazySlide(t);const i=this.slides.find((function(t){return t.idSlide==e}));if(i&&(i.loading=!0),i){const e=new CustomEvent("mapCharge",{detail:{slide:i}});document.dispatchEvent(e)}}this.watchTheSlidesWhatIHaveToCharge()}wasCharged(e){return this.slidesCharged.includes(e)}makeEagerTheLazySlide(e){const t=$("section[id_slide='"+e+"']"),i=$(`.js-slide-frontend[id_slide="${e}"]`);if(t.length>0&&"libre"===t.attr("tipo"))switch(t.attr("fondo")){case"video":const e=t.children("div.fe-fondo.video");if(e.length>0){const t=e.children("video");t.length>0&&t.attr("preload","auto")}break;case"imagen":const i=t.children("img");i.length>0&&i.attr("loading","eager")}!function(e){const t=e.find("div.js-elemento-libre"),i=t.find("img"),a=t.find("video"),s=t.find("iframe");i.each((function(){$(this).attr("loading","eager")})),a.each((function(){$(this).attr("preload","auto")})),s.each((function(){$(this).attr("loading","eager")}))}(i),function(e){const t=e.find("div.js-zona-popup"),i=t.find("img"),a=t.find("video"),s=t.find("iframe");i.each((function(){$(this).attr("loading","eager")})),a.each((function(){$(this).attr("preload","auto")})),s.each((function(){$(this).attr("loading","eager")}))}(i),this.slidesCharged.push(e)}watchTheSlidesWhatIHaveToCharge(){let e,t,i,a,s,o=!0;this.slides.forEach(((a,s)=>{this.slidesWhatIHave.push(a.idSlide),a.idSlide==this.currentSlide&&(e=a,s<this.slides.length-1&&(t=this.slides[s+1]),s<this.slides.length-2?(i=this.slides[s+2],o=!0):o=!1)}));let n=this.slides.length;e.idSlide==this.slides[n-1].idSlide?n=!1:a=t.idSlide,o&&(s=i.idSlide);const r=e=>{const t=[];for(const i in e)if(e[i]instanceof Object){const a=e[i];if(a.funcionalidad){if("gotoslide"===a.funcionalidad.tipoFuncionalidad&&a.funcionalidad.datosFuncionalidad.gotoslide){const e=a.funcionalidad.datosFuncionalidad.gotoslide.id_interno_slide;"Choose your target slide"!==e&&t.push(e)}if("nextslide"===a.funcionalidad.tipoFuncionalidad){const e=this.slides.findIndex((e=>e.idSlide===a.idSlide));-1!==e&&e<this.slides.length-1&&"1"!==this.slides[e+1].slideInfo.oculto&&t.push(this.slides[e+1].slideInfo.id_interno_slide)}}}return t},l=[],c=e.elementos,d=t?t.elementos:null,u=r(c),h=d?r(d):[];l.push(...u,...h);const p=()=>{a&&!this.wasCharged(a)&&this.chargeSlide(a)},f=()=>{s&&!this.wasCharged(s)&&this.chargeSlide(s)},m=()=>{l.map((e=>{const t=this.findSlideInstanceFromIdInternoSlide(e);if(this.slides.includes(t)){const e=Number(t.idSlide);if(!this.wasCharged(e)){this.makeEagerTheLazySlide(e);const t=this.slides.find((function(t){return t.idSlide==e}));if(t&&(t.loading=!0),t){const e=new CustomEvent("mapCharge",{detail:{slide:t}});document.dispatchEvent(e)}}}}))};"botones"!==e.kite.navigation&&p(),o&&"botones"!==i.kite.navigation&&f(),("botones"==e.kite.navigation||l.length>=1)&&m()}objeto(){return"frontend"===this.context?objeto:this.currentKite?this.currentKite.getInfo(this.idKite):void 0}async requestCustomCode(){return this.customcoderequested?this.customcoderequested:new Promise(((e,t)=>{if("dashboard"===this.context)e();else{const i=this;$.ajax({url:this.cdn+"/publico/"+i.kiteInfo.owner+"/src/customcode/"+i.idKite+"_customcode.json",type:"GET",dataType:"json",success:function(t){i.kiteInfo.customcode=t,e()},error:function(e){t(e)}})}}))}createSlideInstanceConIdSlideDashboard(e=null){const t=this.kiteInfo.slides.find((t=>t.id_slide==e)),i=M.createSlide(t,this);this.slides.push(i)}createAllSlidesInstances(){for(const e of this.kiteInfo.slides){const t=M.createSlide(e,this);this.slides.push(t),1==e.oculto&&"frontend"==this.context&&$(`.js-slide-frontend[id_slide="${e.id_slide}"]`).removeClass("swiper-slide").hide()}}gestionaOverflowDesktop(){for(const e of this.kiteInfo.slides)e?.objetoBlobSlide?.navegacion?.overflow&&(this.tieneMousewheel=!1,this.swiper.mousewheel.disable())}findSlideInstanceFromIdSlide(e){return this.slides.find((t=>t.idSlide==e))}findSlideInstanceFromIdInternoSlide(e){return this.slides.find((t=>t.slideInfo.id_interno_slide==e))}cambioSlide(e=null){o.barraCssSlide(this.swiper.activeIndex),o.accionesDependientesDelIndexDeLaSlide(this.context,this.swiper),this.slides.forEach((e=>{e.deactivate()})),this.currentSlide=e||this.swiper.slides[this.swiper.activeIndex].dataset.id_slide,this.chargeSlide(this.currentSlide),this.findSlideInstanceFromIdSlide(this.currentSlide).activate()}getLanguage(){"frontend"==this.context?this.language=$("html").attr("lang"):this.language=$(".js-badge-idioma.js-badge-activo")[0]?.dataset?.idioma||"en"}gestionTamanoScale(){const e=this.kiteInfo?.fullscreen?$(".js-zona-elementos-fullscreen"):$("#js_zona_slides");const t=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/window.document.documentElement.scrollWidth||1,i=window.innerWidth/t,a=window.innerHeight/t,s=e.width(),o=a/e.height(),n=i/s;s*o<i?(e.css("transform",`translate(-50%, -50%) scale(${o})`),document.documentElement.style.setProperty("--scaleFrontend",o),this.scale=o):(e.css("transform",`translate(-50%, -50%) scale(${n})`),document.documentElement.style.setProperty("--scaleFrontend",n),this.scale=n)}pasarCardFormulario(){u.pasarCardFinal()}previousCardFormulario(){u.previousCardFinal()}activateListeners(){this.activateListenersGenerales(),"frontend"===this.context?this.activateListenersOnlyFrontEnd():this.activateListenersOnlyDashboard()}activateListenersGenerales(){const e=this;$(window).resize((()=>{"frontend"===e.context&&e.gestionTamanoScale()}))}activateListenersOnlyFrontEnd(){const e=this;e.swiper.on("slideChangeTransitionStart",(function(){e.cambioSlide()})),$(".js-boton-next").on("click",(()=>{$(document).trigger("clickBotonNext"),e.swiper.slideNext()})),$(".js-boton-previous").on("click",(()=>{$(document).trigger("clickBotonPrev"),e.swiper.slidePrev()})),$(".js-capa-pulsable-derecha").on("click",(function(t){e.swiper.slideNext()})),$(".js-capa-pulsable-izquierda").on("click",(function(t){e.swiper.slidePrev()})),$(".swiper-slide .js-stop-propagation").bind("touchstart touchend touchup",(function(e){e.stopPropagation()})),document.addEventListener("click",(function(t){e.userHasInteracted=!0}),{once:!0,capture:!0}),window.innerWidth<768&&($(document).on("focus","input:not(:checkbox), textarea ",(function(e){$(e.currentTarget).hasClass("js-checkbox-deshabilita-boton")||($("#barra_exploracion").hide(),$(".js-zona-branding").hide())})),$(document).on("focusout","input:not(:checkbox), textarea",(function(t){$(t.currentTarget).hasClass("js-checkbox-deshabilita-boton")||("story"==e.navigation&&$("#barra_exploracion").show(),$(".js-zona-branding").show())})))}activateListenersOnlyDashboard(){}preventDoubleClick(e){return Math.abs(e.timeStamp-this.timeStampGlobal)<280?(this.timeStampGlobal=e.timeStamp,!0):(this.timeStampGlobal=e.timeStamp,!1)}async goToSlide(e,t=0){try{const i=parseInt(t)||0,a=$(`section[data-id_interno_slide="${e}"]`).parent().children(":visible"),s=a.toArray().findIndex((t=>$(t).data("id_interno_slide")==e));if(-1==s)throw new Error("Slide not found");s==this.swiper.activeIndex?this.cambioSlide():this.swiper.slideTo(s,i)}catch(e){throw e}}goToHiddenSlide(e,t=0,i=!1){try{const t=this.findSlideInstanceFromIdInternoSlide(e);this.cambioSlide(t.idSlide),t.slideDivJQuery.show(),t.slideDivJQuery.css("width","100%"),t.slideDivJQuery.css("height","100%"),t.slideDivJQuery.css("position","absolute"),t.slideDivJQuery.css("top","0"),t.slideDivJQuery.css("left","0"),t.slideDivJQuery.css("z-index",9999),t.slideDivJQuery.parent().hasClass("swiper-wrapper")&&t.slideDivJQuery.insertAfter(t.slideDivJQuery.parent()),!1===i&&this.indexStoryHistoryManager.addCurrentSlideToHistory(e)}catch(e){}}updateSwiper(){this.swiper.update()}},window.botonFuncionalidad=l})();